state {
    variable hintsCounter 0;
    variable hintsState "start";
    variable hasPen 0;
    variable dresserOpen 0;
    variable frontDoor "closed";
    # The door must be opened before you leave the entryway
    # in order to get your package
    variable openedDoorFirst 0;
    # Mail person begins at your door, then leaves after giving 
    # you your package
    variable mailWomanPresent 1;
    # Make the doorbell ring the first time you enter the entryway
    variable enteredEntry 0;
    # After chatting with Emily, she returns your package to your door
    variable gotPackageFromEmily 0;
    # Received the final package that actually belongs to you
    variable hasYourPackage 0;
    # Text changes if you bother to learn mail person's name
    variable mailPersonName "the woman";
    # Received package that begins game, but haven't destroyed it yet
    variable hasOrigPackage 0;
    # You've ripped open the original package, and so know it
    # doesn't belong to you
    variable origPackageOpen 0;
    variable hasMedallion 0;
    # From ripped open package in beginning
    variable hasEmptyBox 0;
    variable hasTeapot 0;
    # Get address form ripped box to find Robertson
    variable hasSeenAddress 0;
    variable hasKeys 0;
    variable fridgeOpen 0;
    variable computerState "off";
    # Are you currently browning Swifts.com?
    variable onSwifts 0;
    # Are you logged into the chat room?
    variable onChat 0;
    # Delivered that package that belongs to Emily to here door
    variable returnedEmilyPackage 0;
    # You're in the middle of a conversation with Emily on chat
    variable chatEmily 0;
    # Has package that belongs to Emily and needs to be delivered
    variable hasEmilyPackage 0;
    # Tried to ask for attention enough times at post office
    # that you give up and move on
    variable donePostOffice 0;
    # Counter of number of times you tried to get post office person's
    # attention.
    variable attentionAttempts 0;
    # Has cat jumped out of the tree so you can follow it?
    variable catPresent 0;
    variable hasFlint 0;
    # The correct book must be placed on the chair to start fire
    variable placedBook 0;
    # Which book from the bookshelf are you holding?
    variable heldBook "None";
    # Room periodically lights on fire. 
    # It means you should probably leave
    variable roomOnFire 0;
    # Received love note from couch. Can now open cabinet.
    variable hasNote 0;
    # Received papers from cabinet and need to organize them
    variable hasPapers 0;
    # papers of different colors in correct drawer in cabinet
    variable pinkRight 0;
    variable whiteRight 0;
    variable greenRight 0;
    variable blueRight 0;
    variable yellowRight 0;
    variable hasCatFood 0;
    # Began a conversation with Stuart
    variable beganConv 0;
    # Discovered you needed your keys
    variable triedCar 0;
    # Can't do anything. You have a package.
    variable packagePanic 0;
}

location init {
    command start {
        respond {
            Episode 1: Delivery

            You wake up, ready for another normal day of
            your normal life in your normal little village.



            Hello, says an uncanny little voice in your head
            that just might be your own voice.
            It's time to start exploring. If you're ever unsure what
            to do, type "hint" and I'll offer you some directions. I have
            lots of good advice, so don't be afraid to ask, or even to
            keep pestering me for help if my first (or second) piece of
            advice just isn't enough.

            Let's get started!


        }
        move-to bedroom;
        trigger look;

        # Debugging: uncomment these to automatically
        # advance through game

        #trigger open drawer;
        #trigger go kitchen;
        #trigger open fridge;
        #trigger open butter;
        #trigger go entry;
        #trigger open door;
        #trigger sign package;
        #trigger open package;
        #trigger look package;
        #trigger go outside;
        #trigger drive post office;
        #trigger flail;
        #trigger flail;
        #trigger flail;
        #trigger flail;
        #trigger drive address;
        #trigger look tree;
        #trigger follow cat;
        #trigger open window;
        #trigger take flint;
        #trigger take leaves of grass;
        #trigger put book on chair;
        #trigger burn chair;
        #trigger leave;
        #trigger search couch;
        #trigger open 1;
        #trigger put pink 2;
        #trigger put white 2;
        #trigger put yellow 2;
        #trigger put green 2;
        #trigger put blue 2;
        #trigger leave;
        #trigger open 3;
        #trigger feed cat;
        #trigger leave room;
        #trigger talk man;
        #trigger say 2;
        #trigger look package;
        #trigger say 6;
        #trigger drive emily;
        #trigger deliver package;
        #trigger drive home;
        #trigger go living room;
        #trigger open chat;
        #trigger chat emily;
        #trigger say 6;
        #trigger go entry;
        #trigger open door;
        #trigger open package;
        #trigger go living room;
        #trigger open swifts;
        #trigger buy tea;

    }
}

environment global {
    synonym "" "a" "an" "the" "that" "my" "your";
    synonym "look" "examine" "x" "see" "view" 
    "look at" "look around" "l" "check";
    synonym "take off jacket" "strip" "remove jacket";
    synonym "go" "move" "g" "go in" "go to" "move to" "enter"
    "go into" "goto";
    synonym "" "damn" "fucking" "goddamn" "god damn";
    synonym "living-room" "living room" "livingroom";
    synonym "close" "shut";
    synonym "take" "pick up" "get";
    synonym "package" "box" "packaging" "brown parcel" "parcel";
    synonym "empty package" "torn package" "opened package" "ripped package";
    synonym "entryway" "entrance" "entry way" "entry-way" 
    "entranceway" "entry";
    synonym "talk" "talk to" "speak" "speak with" 
    "converse" "converse with" "talk with";
    synonym "1" "one";
    synonym "2" "two";
    synonym "3" "three";
    synonym "4" "four";
    synonym "5" "five";
    synonym "6" "six";
    synonym "put" "place";
    synonym "hint" "help" "hints" "give hint" "give me hint"
    "what do inventory do now" "what do inventory do" "consult oracle";
    synonym "medallion" "medal";
    synonym "inventory" "i" "look inventory";
    synonym "lint" "bit of lint";
    synonym "money" "some money";
    synonym "ticket" "old ticket stub" "ticket stub" "stub" ;
    synonym "rabbit" "giant stuffed rabbit" "stuffed rabbit";
    synonym "break" "destroy";
    synonym "wear" "put on";
    synonym "sit" "sit on";
    synonym "sing" "sing heart out";
    synonym "heart" "your heart" "your own heart" "own heart"
    "my heart" "my own heart";
    synonym "rip out heart" "rip heart out";
    synonym "die" "kill yourself" "commit suicide";
    synonym "somewhere" "somewhere else" "elsewhere";
    synonym "refuse to be brought down" 
    "inventory refuse to be brought down";
    synonym  "hands" "hand" "own hands" 
    "own hand";
    synonym "scream" "yell" "shout";
    synonym "flail" "wave your arms" "wave arms" "wave";
    synonym "doorbell" "door bell";
    synonym "jump" "leap";
    synonym "you" "yourself" "self";
    synonym "put hands on head" "set hands on head";
    synonym "understand" "understand anything";
    synonym "wall" "plaster";

    # Some display of the items you have, I guess.
    command inventory {
        if `hasPen` {
            respond {
                You have a pen that boldly advertises
                Bert and his tree-trimming abilities.
            }
        }
        if `hasMedallion` {
            respond {
                You have a medallion with a creepy yellow
                eye on it.
            }
        }
        if `or hasYourPackage (or hasOrigPackage hasEmilyPackage)`
        {
            respond {
                You have a package! Packagepackagepackage!
            }
        }
        if `hasEmptyBox` {
            respond {
                You have a visciously torn box that you
                sacrificed in a valient effort to obtain material
                goods. There seems to be an address on the box
                that you're pretty sure isn't yours.
            }
        }
        if `hasKeys` {
            respond {
                You have your keys, which are still nice
                and cold from the refrigerator.
            }
        }
        if `hasFlint` {
            respond {
                You have a piece of flint which you've
                heard is very useful for starting fires.
            }
        }
        if `neq heldBook "None"`{
            respond {
                You have a copy of `heldBook`.
                It doesn't really belong to you.
                You feel a little guilty that it
                somehow ended up stuffed in your pockets.
            }
        }
        if `hasNote` {
            respond {
                You have a nauseatingly pink love note.
            }
        }
        if `hasPapers` {
            respond {
                You have sheets of paper that may or may not
                be lying to you.
            }
        }
        if `hasCatFood` {
            respond {
                You have a handful of questionable cat food.
            }
        }
        if `hasTeapot` {
            respond {
                You have a beautiful teapot but,
                unfortunately, no tea.
            }
        }
        respond {
            You have a bit of lint, some money, and old
            ticket stub, a giant stuffed rabbit...

            Actaully, you have a lot of junk in your pocket.
            Let's stop listing it all.
        }
    }
    # hints for all states, more specific the more you ask
    command hint {
        if `eq hintsState "start"` {
            if `eq hintsCounter 0` {
                respond {
                    Good afternoon--wait, you mean morning!
                    You definitely did not sleep through the
                    whole day. Take some time to look around
                    this lovely house of yours.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    You might just have a package coming.
                    You love packages! You should check the entryway.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Go to the entryway and get the
                    package when the doorbell rings.
                    Packages!
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "mail"` {
            if `eq hintsCounter 0` {
                respond {
                    There's a package for you!
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Open the door and get your package!
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Open the door and greet the mailwoman. She'll
                    want you to sign for your package.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "pen"` {
            if `eq hintsCounter 0` {
                respond {
                    You need to get a pen to sign for your package.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    You think you left a pen in your bedroom somewhere.
                }
            }
            if `eq hintsCounter 2` {
                respond {
                    Maybe that pen was in the dresser in your bedroom?
                }
            }
            if `gt hintsCounter 2` {
                respond {
                    Go to your bedroom, open the dresser, get your
                    pen, and come sign for this package
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "sign"` {
            if `eq hintsCounter 0` {
                respond {
                    Go sign for that package! Oh man,
                    packages!
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Now that you have your pen,
                    you should go to the mailwoman and
                    sign for you package.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Go to the mailwoman in the entryway
                    and sign for your package.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `or (eq hintsState "open1") (eq hintsState "open2")` {
            if `eq hintsCounter 0` {
                respond {
                    Package, package, package!
                    Open it!
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Open your package! Now!
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    This is pathetic. You have temporarily
                    lost the privilege of control. You 
                    have no will of your own. The package
                    demands to be open.
                }
                trigger open package;
                respond {
                    Ok, you have your control back.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "address"` {
            if `eq hintsCounter 0` {
                respond {
                    You're pretty sure this medallion does
                    not belong to you. Maybe you should find
                    out who it does belong to.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Did you try looking at the empty package?
                    Maybe there's an address on there.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Examine the empty package. The address
                    for the medallion's real owner will be
                    on there.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "post"` {
            if `eq hintsCounter 0` {
                respond {
                    That package sadly wasn't
                    meant for you. Maybe you should
                    return it to the post office.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    You have a car you
                    can drive to the post office in
                    order to return that package like
                    a moral and upright citizen.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Go outside to your car and drive to the
                    post office.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "keys"` {
            if `eq hintsCounter 0` {
                respond {
                    You need to find your keys if
                    you want to drive anywhere. They're
                    probably in the place you always keep
                    them.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Have you tried checking the kitchen?
                    You like keeping your keys with your
                    food so that you remember that you should
                    leave your house every once in a while
                    when you eat.
                }
            }
            if `eq hintsCounter 2` {
                respond {
                    You love the feel of cold keys. Maybe
                    you should check the refrgerator.
                }
            }
            if `eq hintsCounter 3` {
                respond {
                    You're pretty sure those keys are 
                    somewhere on the shelves inside the 
                    fridge door.
                }
            }
            if `eq hintsCounter 4` {
                respond {
                    That butter dish sitting on the shelves
                    in the refrigerator is just the perfect
                    size for your keys.
                }
            }
            if `gt hintsCounter 4` {
                respond {
                    Go to the kitchen, open the refrigerator,
                    and then open the butter dish. Your keys
                    should be there, right where you always
                    put them.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "attention"` {
            if `eq hintsCounter 0` {
                respond {
                    If you want to get this
                    medallion to its correct owner,
                    you're going to need to get
                    that man's attention.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    You have tons of good ideas
                    about what you should do. You could
                    scream, wave your arms, punch the man,
                    burn down the post office... You know,
                    those kind of methods. He looks
                    pretty preoccupied, though.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Try to wave your arms, or scream, or punch
                    the man, or burn down the post office.
                    Maybe if you try a bunch of them one will
                    work.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "deliver1"` {
            if `eq hintsCounter 0` {
                respond {
                    You have failed to get the
                    attention of the man working at the post
                    office, so you are going to take
                    matters into your own hands and deliver
                    the medallion yourself. Luckily, you
                    know the address of the man who owns the
                    medallion, so off you go!
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Your car is waiting. The address is
                    on the opened package. Go get in that car
                    and deliver that package yourself.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Drive to Mr. Robertson's house to deliver
                    the medallion to him.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "findCat"` {
            if `eq hintsCounter 0` {
                respond {
                    What a nice yard. You should look
                    around and see what you can find.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Have you checked out that tree over
                    there? It's a pretty nice tree.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Examine the tree and see if you 
                    find anything.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "followCat"` {
            if `eq hintsCounter 0` {
                respond {
                    A cat jumped out of a tree!
                    You've heard it's good luck to follow
                    black cats. You're not sure who
                    you heard that from, but it's probably
                    true.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    The cat jumped out of the tree and went
                    through the bushes. There might be
                    something interesting behind those bushes.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Follow that cat! You really don't know why,
                    but hey, at this point, even the hints voice
                    in your head is telling you to do it, so
                    it must be right.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "enterHouse"` {
            if `eq hintsCounter 0` {
                respond {
                    Where did that cat go? Maybe
                    you can find her.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    That window looks slightly open...
                }
            }
            if `eq hintsCounter 2` {
                respond {
                    Maybe you could get into the house through
                    the window.
                }
            }
            if `gt hintsCounter 2` {
                respond {
                    Open the window and see if you can
                    squeeze yourself inside. Maybe the
                    cat is in there. 
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "burn"` {
            if `eq hintsCounter 0` {
                respond {
                    That painting on the wall
                    feels really suggestive. You feel
                    like imitating it.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    You have an uncontrolable desire to
                    set the armchair on fire. You might want
                    to talk to a therapist about these
                    uncontrollable desires, but now is not the
                    time. Now is the time for fire!
                }
            }
            if `eq hintsCounter 2` {
                respond {
                    You're going to need some flint and
                    paper to start this fire.
                }
            }
            if `eq hintsCounter 3` {
                respond {
                    You can find some flint in the rock
                    collection and those books on the 
                    bookshelf would be good for paper.
                }
            }
            if `eq hintsCounter 4` {
                respond {
                    Set the right book down on the chair
                    and then use the flint to set it all 
                    on fire. Then you might want to see a
                    therapist, but we'll worry about that 
                    later.
                }
            }
            if `eq hintsCounter 5` {
                respond {
                    The "Leaves of Grass" book is a little
                    boring. That would probably be your first
                    choice for burning material. Set that book on
                    the chair, grab some flint, and light 
                    yourself a fire.
                }
            }
            if `gt hintsCounter 5` {
                respond {
                    First take a piece of flint from the rock
                    collection. Next, pick up "Leaves of Grass"
                    and place it on the chair. Then set it all
                    on fire and watch it burn. Burn!
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "fire"` {
            if `eq hintsCounter 0` {
                respond {
                    The room's on fire. Do I
                    reeally need to tell you to get out?
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Leave the room. It's on fire! Really!
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Ok, this is stupid. If you really aren't
                    intelligent enough to leave a room as
                    it burns down in front of you, we need
                    to have a serious intervention here. So
                    I'm taking over for you and moving you out
                    of this room. Let's go.
                }
                trigger leave;
                respond {
                    Ok, you're safe for now. You're in
                    control. Don't make me regret this.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "scorch"` {
            if `eq hintsCounter 0` {
                respond {
                    There's some scorch marks
                    on the ground over there.
                    You wonder what they look like.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Look at those scorch marks. You think
                    they might have some information.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Seriously, those scorch marks on the ground
                    are calling your name. Well, not literally.
                    That would be strange. Still, examine the
                    scorch marks.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "notes"` {
                if `eq hintsCounter 0` {
                respond {
                    That scorch mark looked like a person
                    searching through a couch for old love
                    notes. It felt rather suggestive.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    There's a couch over there. You
                    wonder if it contains anything
                    interesting.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Look through the couch. See what you find.
                    The scorch marks feel particularly
                    suggestive.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "organize"` {
            if `eq hintsCounter 0` {
                respond {
                    That note you found had some interesting
                    suggestions. You should follow them
                    and organize the cabinet. You've followed
                    worse advice before.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    There are some papers in the top
                    drawer of the cabinet that say where they
                    belong. Put them in the first and second
                    drawers as they demand. The third drawer
                    doesn't seem to open, so you see no reason
                    to worry about it.
                }
            }
            if `eq hintsCounter 2` {
                respond {
                    Try to figure out which papers are lying
                    and which aren't by which combination
                    does not lead to a contradiction. Then
                    place the papers that are telling the truth
                    in the drawers they ask for and the ones that
                    are lying in the opposite drawers than the ones
                    they ask for.
                }
            }
            if `eq hintsCounter 3` {
                respond {
                    The yellow paper is lying. You should put
                    it in drawer 2.
                }
            }
            if `gt hintsCounter 3` {
                respond {
                    Put the yellow, blue, green, and white
                    papers in drawer 2. The pink paper can go
                    in either of the drawers.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "cabinet"` {
            if `eq hintsCounter 0` {
                respond {
                    The cabinet seems to be in
                    pretty bad shape. Maybe you
                    can see what's in the thrid drawer
                    now.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    The thrid drawer of the cabinet
                    looks like it has something inside
                    it. You should check it out.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Look at drawer 3.
                }
            }
        }
        if `eq hintsState "feed"` {
            if `eq hintsCounter 0` {
                respond {
                    You have cat food. There's
                    a cat watching you. You wonder what you
                    could possibly do in this situation.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Here kitty kitty. Look you have food!
                    Eat the food, kitty kitty!
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Now you're just being rude. There's a
                    cat over there and she's hungry. Feed
                    the cat.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "giveMedallion"` {
            if `eq hintsCounter 0` {
                respond {
                    You finally found Mr. Robertson!
                    And, actually, he's kind of handsome. He
                    might like you more if you gave him the
                    medallion.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    That medallion actaully belongs to
                    Mr. Robertson. You should give it
                    to him regardless of whether you
                    think it will make him like you more.
                    (But it probably will!)
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Talk to mr. Robertson and give him
                    his medallion so youcan get out of here.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "deliver2"` {
            if `eq hintsCounter 0` {
                respond {
                    You have a package! But unfortunately,
                    once again,the package does not belong
                    to you. You should give it to Emily. 
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    You should drive to Emily's house and leave
                    it at her doorstep. You probably won't
                    see her, but that's ok.
                }
            }
            if `eq hintsCounter 2` {
                respond {
                    Say goodbye to Mr. Robertson and drive
                    to Emily's house to leave her package
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Tell Mr. Robertson that you should be
                    going, drive to Emily's house, and deliver
                    her package.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "chat"` {
            if `eq hintsCounter 0` {
                respond {
                    Now that you've delivered Emily's pacakge,
                    you should probably tell her. She won't
                    look outside her door otherwise. She
                    will be on chat, though.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Turn on your computer in your living room
                    to talk to Emily.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Go to the living room, turn on your computer,
                    open chat, and tell Emily that you left her
                    package at her door.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "yourPackage"` {
            if `eq hintsCounter 0` {
                respond {
                    Emily left you a package! You should go
                    get it.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    The package will be right outside your door.
                    Packages!
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Go to the entryway, open the door, and
                    get your package. Packagepackagepackage!
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "tea"` {
            if `eq hintsCounter 0` {
                respond {
                    You have a teapot! But, sadly, no tea.
                    You should buy some tea! You bet Swifts
                    sells tea.
                }
            }
            if `eq hintsCounter 1` {
                respond {
                    Go on to your computer and buy tea from
                    Swifts.
                }
            }
            if `gt hintsCounter 1` {
                respond {
                    Go to the living room, turn on the computer,
                    open Swifts, and buy some tea.
                }
            }
            set hintsCounter `add hintsCounter 1`;
        }
        if `eq hintsState "won"` {
            respond {
                You won! Go take a nap or two or three and
                wait for next episode when that exciting
                five-pound bag of tea will arrive!
            }
        }
    }
    command cry {
        respond {
            You curl up in a ball and cry. Then you get
            back up and feel a lot better.
        }
    }
    command smile {
        respond {
            You smile broadly. You are so happy to be 
            right here right now.
        }
    }
    command frown {
        respond {
            You frown broadly. You are so sad to be 
            right here right now.
        }
    }
    command win game {
        respond {
            You win!


            Just kidding. Keep trying.
        }
    }
    command tear hair {
        respond {
            You tear out a clump of your hair.
            You think it will be dramatic, but it's mostly just painful.
        }
    }
    command chortle {
        respond {
            You laugh in what you want to belive is a happy
            and care-free manner. It mostly comes off as creepy.
        }
    }
    command smell lint {
        respond {
            Linty, not minty.
        }
    }
    command read ticket {
        respond {
            Front row tickets for only $35.99. Definitely worth it
            to see that hot romantic lead. Too bad the ticket
            is two years old.
        }
    }
    command kill {
        respond {
            That might be a little excessive.
        }
    }
    command cry you to sleep {
        respond {
            As depressed as you feel, it will take several
            hours for you to fall asleep and that's a lot of crying.
        }
    }
    command poke eye {
        respond {
            You poke yourself in the eye. You're pretty stupid.
        }
    }
    command do victory dance {
        respond {
            You do a jig to celebrate your accomplishments.
        }
    }
    command metaphor {
        respond {
            A metaphor is an examining of the soul.
        }
    }
    command do something thrilling {
        respond {
            You destroy a neighboring town. It was kind of thrilling.
        }
    }
    command stop being slob {
        respond {
            You can't fight nature.
        }
    }
    command aim to misbehave {
        respond {
            You have a hard time aiming to do anything. You just
            kind of wander around aimlessly.
        }
    }
    command look room {
        trigger look;
    }
    command stare at wall {
        trigger look wall;
    }
    command look wall {
        respond {
            The lump of plaster almost looks like a cloud.
        }
    }
    command put hands on head {
        respond {
            You place your hands on your head, then strut
            around like you're wearing a crown. Of hands. Which you are.
        }
    }
    command do hokey pokey {
        respond {
            You turn yourself around because that's what it's
            all about.
        }
    }
    command inventory dont understand {
        respond {
            It's ok. Nothing understands you.
        }
    }
    command eat heart {
        respond {
            You rip out your heart, only to find a purple plushie.
            You try to take a bite, but it's not very tasty. You
            seal it back in your chest and proceed with life.
        }
    }
    command defy gravity {
        respond {
            In the spirit of defiance, you jump as high as you can! 
            Just when you think you've won, you fall back to the ground.
            Curse you, gravity! Next time you'll win.
        }
    }
    command explore unknown {
        respond {
            You jump into the unknown. Then it becomes known.
            You jump out of the thing that was once the unknown.
        }
    }
    command import antigravity {
        respond {
            You're flying! You're flying! You soar around for a while,
            but then Python crashes and you fall. Ouch.
        }
    }
    command break mothers heart {
        respond {
            It was broken as soon as you were born.
        }
    }
    command dance {
        respond {
            Your body moves to the music in your head, 
            and you perform a stunning combination of tap dancing,
            Salsa, and grinding. It's pretty spectacular.
        }
    }
    command smash patriarchy {
        respond {
            You bring your fist down on the partriarchy, intending
            to smash it to bits. Your move is ineffective.
        }
    }
    command do homework {
        respond {
            You are a mature and responsible adult. That means you
            don't have to deal with things like "homework," right?
        }
    }
    command divide by zero {
        respond {
            Success!
        }
    }
    command look soul {
        respond {
            It's dark in there.
        }
    }
    command set hair on fire {
        respond {
            You place your lighter near your hair and attempt to
            light it on fire. Sadly, the hair fails to catch and just
            kind of smells bad.
        }
    }
    command error command unavailable {
        respond {
            The command is always available for you.
        }
    }
    command raise roof {
        respond {
            You lift your hands in a raise the roof kind of motion,
            arms fail to reach the ceiling, leavng the roof unraised.
        }
    }
    command be awesome {
        respond {
            You already are awesome.
        }
    }
    command eat arm {
        respond {
            You gnaw on your arm for a moment, but you've had
            better cuisine.
        }
    }
    command break glass ceiling {
        respond {
            You metaphorically jump so high that 
            the metaphorical glass ceiling just metaphorically 
            shatters, unleashing a rain of metaphorical glass shards
            onto your head.
        }
    }
    command hello {
        respond {
            "Hi!" you respond. You love talking to yourself.
        }
    }
    command have starting contest with medallion {
        if `hasMedallion` {
            respond {
                You stare unblinkingly at the medallion, but it 
                stares back at you for longer.
            }
        }
        else {
            respond {
                You don't have a medallion.
            }
        }
    }
    command smolder {
        respond {
            You smolder perfectly. Sadly, only you seem to
            be aware of your perfect smoldering.
        }
    }
    command build altar {
        respond {
            You build an altar to the gods. The gods do not respond.
            You get rid of the altar.
        }
    }
    command jump {
        respond {
            You jump so high, it's a miracle! And then you fall
            ungracefully to the earth. Less of a miracle.
        }
    }
    command kick * {
        respond {  
            Ouch your foot! It does not help.
        }
    }
    command die {
        respond {
            You know it's been a long day, but you aren't that
            desperate yet. You really aren't.
        }
    }
    command flail {
        respond {
            You wave you arms around in the air, as if
            attempting to communicate with some invisible, or possibly
            very visible, entity. Either way, no one seems to be
            paying attention to you. But let's be honest here: that's
            probably for the best.
        }
    }
    command scream {
        respond {
            You yell as loudly as your poor lungs permit. The world
            ignores you. 
        }
    }
    command rip out heart {
        respond {
            You claw your nails into the cavities of your chest.
            You pull out a purple plushie heart. You smile for a
            moment, then expertly seal it back away in your chest.
            No one will be able to tell the difference.
        }
    }
    command sing {
        respond {
            You let out your loundest and most beautiful notes
            of pure music. Your neighbors should be paying for
            this quality of entertainment.
        }
    }
    # Why am I even adding this? inventory for i
    command refuse to be brought down {
        respond {
            Of course you do. Just keep up refusing. No one will stop
            you. It's ok. Shhhhhhhhh.
        }
    }
    command look pen {
        if `hasPen` {
            respond {
                "GET TO THE ROOT OF THE PROBLEM! BERT'S TREE TRIMMING"
            }
        }
        else {
            respond {
                Pen? What pen?
            }
        }
    }
    command look package {
        if `hasYourPackage` {
            respond {
                This one has your name and address. Finally.
            }
        }
        else {
            if `and hasOrigPackage (not origPackageOpen)` {
                respond {
                    An ordinary brown cardboard package with an 
                    address scribbled in red ink.
                    The address readsâ€“oh who cares! You have a
                    package! Packages are meant to be opened!

                    You rip open the packaging, excited to discover
                    what present lay in its depth. You love surprises.
                    Well, to be honest, you had ordered this
                    package for yourself, but that was 
                    over a week ago and
                    who remembers what they ordered a week ago?
                    You have a busy life to lead.
                    
                    After struggling with the packing tape
                    for about a minute (it's difficult,
                    really!) you manage to
                    open the box. Inside, beneath a 
                    layer a packaging peanuts, sits a smooth 
                    black medallion
                    with the embossed image of a 
                    narrow, yellow eye. You're pretty sure that's not
                    something you would have ordered,
                    but maybe your decorative medallion tastes changed
                    drastically in the past week. 
                    You pocket the strange object anyway.
                }
                set origPackageOpen 1;
                set hasOrigPackage 0;
                set hasMedallion 1;
                set hasEmptyBox 1;
                if `eq hintsState "open1"` {
                    set hintsState "address";
                    set hintsCounter 0;
                }
            }
            else {
                if `hasEmilyPackage` {
                    respond {
                        A beautiful package. Well, all packages are
                        beautiful. But when you look at the address,
                        ready to see
                        your name written in beautiful black ink,
                        it's not there. This package belongs
                        to Emily. Really? Again? At least she lives
                        near your house this time. And no more trying
                        the stupid post office.
                    }
                    set packagePanic 0;
                }
                else {
                    if `origPackageOpen` {
                        trigger look empty package;
                    }
                    else {
                        respond {
                            What package? You wish you had a package.
                            Packages make life better.
                        }
                    }
                }
            }
        }
    }
    command open package {
        if `hasYourPackage` {
            respond {
                It took a lot of effort to get your
                hands on this package, you think
                to yourself as you unwrap
                it. It better be worth it, whatever
                it is. Oh, that's right. A teapot
                shaped like a head of
                fresh cabbage falls into your lap.
                Perfect. How could you have forgotten about ordering
                this? Just looking at it makes
                you want to drink tea, so you search the bottom of the
                package for some teabags. Nothing.
                Apparently you ordered a teapot
                but no tea. Good job, you.
                You allow a moment of sheer disappointment
                to flood over you before you remember that
                Swifts sells some really good tea. You
                should order some.
            }
            set hasYourPackage 0;
            set hasTeapot 1;
            set hintsState "tea";
            set hintsCounter 0;

        }
        else {
            if `and hasOrigPackage (not origPackageOpen)` {
                respond {
                    You rip open the packaging, excited
                    to discover what present lay in
                    its depth. You love surprises.
                    Well, to be honest, you had ordered this
                    package for yourself, but that was over
                    a week ago and
                    who remembers what they ordered a week ago?
                    You have a busy life to lead.
                    
                    After struggling with the packing tape
                    for about a minute (it's difficult,
                    really!) you manage to
                    open the box. Inside, beneath a layer
                    a packaging peanuts, sits a smooth black medallion
                    with the embossed image of a
                    narrow, yellow eye. You're pretty
                    sure that's not
                    something you would have ordered,
                    but maybe your decorative medallion tastes changed
                    drastically in the past week.
                    You pocket the strange object anyway.
                }
                set origPackageOpen 1;
                set hasOrigPackage 0;
                set hasMedallion 1;
                set hasEmptyBox 1;
                if `eq hintsState "open1"` {
                    set hintsState "address";
                    set hintsCounter 0;
                }
            }
            else {
                if `hasEmilyPackage`  {
                    respond {
                        You figure this time you might want to check
                        the address before ripping the package to
                        shreds. But even this package doesn't belong
                        to you. It belongs to Emily, you know that
                        girl that only ever talks to you in the
                        internet chatroom even though she lives
                        practically next door? I mean, really.
                    }
                    set packagePanic 0;
                }
                else {
                    respond {
                        What package? You wish you had a package. 
                        Packages make life better.
                    }
                }
            }
        }
    }
    command look teapot {
        if `hasTeapot` {
            respond {
                It's shaped like a head of cabbage. You're
                not sure anything in the world could be
                more perfect. Except, maybe, if it had
                tea in it. You should order some.
            }
        }
        else {
            respond {
                You don't see a teapot. You could use a
                teapot. You wonder if you ordered one.
            }
        }
    }
    command its mine {
        respond {
            Not everything belongs to you. There are some harsh lessons
            you must learn.
        }
    }
    # i cinnamoned to inventory
    command inventory want * {
        respond {
            You really do want it. Of course you want it. But
            sometimes you can't have it.
        }
    }
    command look medallion {
        if `hasMedallion` {
            respond {
                A smooth, black medallion with
                a somewhat creepy yellow eye. The eye
                seems to follow you with its gaze.
            }
            if `hasSeenAddress` {
                respond {
                    Sadly, the medallion does not belong
                    to you. You should probably return
                    it to its owner.
                }
            }
            else {
                respond {
                    You don't think you bought a creepy
                    medallion, though you could be wrong.
                    Maybe you should check the opened
                    package to see the address that it
                    was supposed to go to.
                }
            }
        }
        else {
            respond {
                A medallion! That would be cool to look at.
                Unfortunately, you don't have one.
            }
        }
    }
    command take off jacket {
        respond {
            Being cold is against your general life strategy.
        }
    }
    command lick medallion {
        if `hasMedallion` {
            respond {
                You lick the medallion.
            }
        }
        else {
            respond {
                A medallion! That would be cool to lick.
                Unfortunately, you don't have one.
            }
        }
    }
    command eat medallion {
        if `hasMedallion` {
            respond {
                You stuff the medallion down your throat.
                For a moment, you gain the ability to meow like
                a cat. Then the medallion decides it's time to
                come back up, and you regurgitate it.
            }
        }
        else {
            respond {
                A medallion! That would be cool to lick.
                Unfortunately, you don't have one.
            }
        }
    }
    command take medallion {
        if `hasMedallion` {
            respond {
                You already have a creepy medallion.
            }
        }
        else {
            respond {
                A medallion! That would be cool to lick.
                Unfortunately, you don't have one.
            }
        }
    }
    command wear medallion {
        if `hasMedallion` {
            respond {
                You place the medallion over your neck.
                You suddenly feel a strong affection
                for cats. Or maybe you just always felt
                a strong affection for cats. You love cats!
                You remove the medallion. Sure enough,
                you still love cats.
            }
        }
        else {
            respond {
                A medallion! That would be cool to wear.
                Unfortunately, you don't have one.
            }
        }
    }
    command look keys {
        if `hasKeys` {
            respond {
                Jingle, jingle, jangle! They're still nice
                and cold from the fridge. Just the way you
                like them.
            }
        }
        else {
            respond {
                Where did those keys go?
            }
        }
    }
    command look lighter {
        respond { 
            Your trusty lighter! You take it everywhere.
        }
    }
    command look empty package {
        if `hasEmptyBox` {
            respond {
                The cardboard box has been torn
                to shreds by your previous eagerness
                to open the package.
                You really wanted that material good.
                However, you can still piece together the cardboard
                well enough to read the address.
                In legible red ink, it reads:
                
                Mr. Robertson
                
                13310 Podwoic Avenue
                
                Hey, that's not your address! The post office
                must have mistakenly delivered you
                the wrong package.
                You should probably return the
                creepy medallion to its owner since it
                isn't actually yours.
                You're a little disappointed since you've grown
                somewhat attached to the creepy eye
                during the brief moments you've shared with it,
                but hey, this just means your actual package
                is still on its way!
            }
            if `not hasSeenAddress` {
                respond {
                    You should return this to the post
                    office. It's a short drive.
                }
                set hasSeenAddress 1;
                if `eq hintsState "address"` {
                    set hintsState "post";
                    set hintsCounter 0;
                    if `and triedCar (not hasKeys)`{
                        set hintsState "keys";
                    }
                }
            }
        }
        else {
            respond {
                You wish you had an empty box.
                That would mean you once had a full box.
            }
        }
    }
    command break game {
        respond {
            Bzzzzzzzzz.....zap!

            Sadly, you fail to break the game, because this game is
            invincible.
        }
    }
    command break *{
        respond {
            You raise your arms above your head, ready to unleash
            your smashing powers. Then you stop yourself. Today is
            not a day for destruction.
        }
    }
    command drop * {
        respond {
            You want it. You refuse to let go of it. Ever.
        }
    }
    object hands {
        Handy.
    }
    object jacket {
        So warm. So fuzzy. Fuzzy warm.
    }
    object lint {
        Lint in your pockets. Completely ordinary, you think.
    }
    object money {
        Approximately $5.33, but you do all of your
        purchasing on Swifts.com, so you don't need
        cash.
    }
    object rabbit {
        About four four feet tall and three feet wide
        when completely fluffed to its full potential.
        It still, somehow, manages to fit in your pockets.
        Impressive.
    }
    object ticket {
        An old ticket stub to that play you saw two years
        ago. You know, that one with the hot romantic lead.
    }
    object you {
        You are wonderful.
    }
    object junk {
        No material good could ever be junk.
    }
}
    
environment house global {
    synonym "outside" "outdoors" "car" "greater outside world";
    synonym "emily" "emilys" "emilys house" 
    "emily house" "emily's place";
    synonym "post office" "post-office" "postoffice";
    synonym "exit" "exit door" "go door" "go through door";
    synonym "1" "say 1";
    synonym "2" "say 2";
    synonym "3" "say 3";
    synonym "4" "say 4";
    synonym "5" "say 5";
    synonym "6" "say 6";


    command go emily {
        respond {
            Your car's outside.
        }
    }
    command wander listlessly {
        respond {
            You wander around some rooms. It's pretty listless.
        }
    }
    command go swifts {
        respond {
            Swifts exists on the internet. You can't actually
            go there, but maybe you can in spirit on the computer.
        }
    }
    command find cat {
        respond {
            Sadly, you don't own a cat.
        }
    }
    command take pen {
        trigger find pen;
    }
    command take keys {
        trigger find keys;
    }
    command find pen {
        if `hasPen` {
            respond {
                It's in your pocket, genius.
            }
        }
        else {
            respond {
                You think you left a pen in the bedroom.
            }
        }
    }
    command find keys {
        if `hasKeys` {
            respond {
                It's in your pocket, genius.
            }
        }
        else {
            respond {
                You think you left your keys in the kitchen.
            }
        }
    }
    command go post office {
        respond {
            Your car's outside.
        }
    }
    command take furniture {
        respond {
            You have pretty big pockets, but not quite that big.
        }
    }
    command open furniture {
        respond {
            You're pretty sure not all of your furniture can open,
            and right now you don't have the energy to test this out.
        }
    }
    command open door {
        respond {
            You never believed in closing this door anyway. In your
            house, you can get to the bedroom, kitchen, bathroom, entryway,
            and living room without meeting such artifical barriers
            as closed doors.
        }
    }
    command go room {
        respond {
            Which room?
        }
    }
    command go living-room {
        move-to living-room;
        trigger look;
    }
    command go kitchen {
        move-to kitchen;
        trigger look;
    }
    command go entryway {
        move-to entryway;
        trigger look;
        if `not enteredEntry` {
            respond {
                The doorbell rings! That must be your package!
            }
            set enteredEntry 1;
            if `eq hintsState "start"` {
                set hintsState "mail";
                set hintsCounter 0;
            }
        }
    }
    command go bathroom{
        move-to bathroom;
        trigger look;
    }
    command go bedroom{
        move-to bedroom;
        trigger look;
    }
    command go outside{
        if `and mailWomanPresent (eq frontDoor "open")` {
            respond {
                It seems rude to just walk past `mailPersonName`
                while she is trying to
                deliver your package. Who knows how long she
                will stand there, waiting for you to sign?
            }
        }
        else {
            if `eq frontDoor "closed"` {
                if `or mailWomanPresent gotPackageFromEmily` {
                    respond {
                        The front door is closed. How can you
                        ever go outside?
                    }
                }
                else {
                    respond {
                        You first open the front door and stare
                        bleakly into the outside world.
                    }
                    set frontDoor "open";
                    trigger go outside;
                }
            }
            else {
                if `returnedEmilyPackage` {
                    respond {
                        You really have no desire to leave your
                        house even one more time today. You're
                        going to stay right here even if the world
                        crumbles around you. Especially if the world
                        crumbles around you.
                    }
                }
                else {
                    respond {
                        Ah, the great outdoors. As freezing cold
                        and inhospitable as ever.
                        To be honest, standing outside
                        in the middle of winter staring vacantly into
                        space is not one of your favorite
                        activities. Being inside would be much better.
                        Your car is sitting in the driveway,
                        waiting. Good car.
                    }
                    move-to outdoors;
                }
            }
        }
    }
    object door {
        A nice door.
    }
    object furniture {
        In general, Swedish and self-assembled. Poorly self-assembled.
    }
    object floor {
        Pretty solid. It hasn't failed you yet.
    }
    object outside {
        Cold. You're glad you're inside.
    }
    object apartment {
        You would describe your apartment's size as "cozy." You would also
        describe you arpartment's cleanliness as "cozy." In fact, "cozy"
        is a great work to describe something you don't really want to
        describe.
    }
}

location bedroom house {

    synonym "night-table" "night-stand" "nighttable" "night table" "table";
    synonym "drawer" "top drawer" "first drawer";
    synonym "bottom drawer" "second drawer";
    synonym "open closet" "clamber over furniture" "go corner"
     "go back corner";
     synonym "open drawer" "look in dresser" "look in drawer";
    synonym "blankets" "blanket" "covers" "cover";
    synonym "sleep" "nap" "doze off" "take in bed";
    synonym "clothes" "clothing" "shirt" "shirts";
    synonym "clean" "tidy" "clean room" "tidy up" "tidy room"
    "pick up clothes";
    
    command look {
        respond {
            You've done a really great job decorating.
            Your dirty clothes make a very modern,
            chic floor covering.
            Really accents your Swedish self-assembled furniture.

            Most of the room is taken up by your
            bed, but you've managed to
            squeeze in a dresser and a night table.
            There's a closet in the back corner only
            accessible by clambering over your
            furniture. So stylish.

            Your bedroom opens up onto the living room.
        }
    }
    command exit {
        trigger go living room;
    }
    command take pen {
        if `hasPen` {
            respond {
                You already have a pen.
            }
        }
        else {
            respond {
                You don't see a pen. Maybe there's one in the dresser?
            }
        }
    }
    command wear clothes {
        respond {
            You have clean, fluffy clothes. You don't need 
            these clothes for wearing. They make good decoration,
            though.
        }
    }
    command take dresser {
        respond {
            You don't have enough muscles to pick up
            this dresser. You're kind of wimpy. You just
            leave it alone.
        }
    }
    command open dresser {
        trigger open drawer;
    }
    command open bottom drawer {
        respond {
            This isn't your finest work of furiture assembly.
            The drawer doesn't open.
        }
    }
    command open night-table {
        respond {
            You pry the top of the night table off. Wait, you're
            pretty sure that's not supposed to happen. You quickly
            put it back together.
        }
    }
    command sit bed {
        respond {
            You really shouldn't sit on your bed. You
            might never get up.
        }
    }
    command sit night-table {
        respond {
            You're not sure this night table will hold your
            weight and you don't feel like finding out.
        }
    }
    command just go back to bed {
        respond {
            You will live your life to its fullest! Or at least not
            sleep through every day.
        }
    }
    command take blankets {
        respond {
            There doesn't really seem to be a point to doing this.
            You're already wearing a jacket, 
            and you don't want to mess up their current placement.
            It's pretty damn cozy.
        }
    }
    command sleep {
        respond {
            Remember how you just woke up? You don't
            feel tired enough to go to sleep right now.
        }
    }
    command go closet {
        respond {
            You're pretty sure your closet offers a portal
            to a new world, but you've never managed to find yet
            even though you've entered your closet many times.
        }
    }
    command open drawer {
        if `dresserOpen` {
            respond {
                The drawer is already open.
            }
        }
        else {
            if `hasPen` {
                respond {
                    The drawer is empty.
                }
            }
            else{
                respond { 
                    The only thing you found worth putting in this
                    drawer was a cheap plastic pen
                    advertising BERT'S TREE TRIMMING. Too 
                    bad you don't have any trees to trim.

                    You pocket the pen.
                }
                set dresserOpen 1;
                set hasPen 1;
                if `eq hintsState "pen"` {
                    set hintsState "sign";
                    set hintsCounter 0;
                }
            }
        }
    }
    command close drawer {
        if `dresserOpen` {
            respond {
                You close the dresser drawer.
            }
            set dresserOpen 0;
        }
        else {
            respond {
                Your dresser is already open.
            }
        }
    }
    command clean {
        respond {
            You pick up a shirt and put it down again.
            It's so much easier to find clothing 
            when it's spread out, covering everything,
            like some sort of locust plague.
            You become too busy contemplating locust plagues
            to continue cleaning.
        }
    }
    command take clothes {
        trigger clean room;
    }
    command clean clothes {
        trigger clean room;
    }
    command open closet{
        respond {
            The word 'closet' traces its origins back
            to Greek tamieion, 'chamber, secret room.'
            But you are certain there is not and will
            never be anything secret about your closet.
            There's no compelling reason to go over
            there right now - the day is fresh, there are
            better things to be doing!
        }
    }
    object clothes {
        Look like you, smell like you. Are tragically not corporeal.
    }
    object dresser {
        A nice two drawer unit. It would be nicer
        if the second drawer actually opened,
        but you weren't at your best when you assembled
        this. Given your current organizational system,
        this dresser's purpose is more decorative
        than functional. Yet another part of your elaborate
        fiction concerning your ability to act as a responsible adult.
        Oh, it's not a fiction? My mistake.

        At least the top drawer works.
    }
    object closet {
        The word 'closet' traces its origins back to
        Greek tamieion, 'chamber, secret room.'
        But you are certain there is not and will
        never be anything secret about your closet.
        There's no compelling reason to
        go over there right now - the day is fresh, there are
        better things to be doing!
    }
    object night-table {
        That's a nice box you call a table.
    } 
    object bed {
        There are so many blankets. You may be cold blooded.

        For a moment, you ponder whether blankets
        would even help if you were cold blooded. Then
        you remember that you love blankets.
    }
    object blankets {
        Blue. Carefully piled.
    }
    object drawer {
        The top one opens. The bottom one does not.
    }
    object floor covering {
        Those dirty clothes probably look better than any purposeful
        decoration you could come up with.
    }
    object bottom drawer {
        Not your finest piece of self-assembled furniture.
    }
}

# Set up for entryway
location entryway house {
    synonym "woman" "mailwoman" "mailperson" "patty" "mail person"
     "delivery person" "delivery woman" "person" "deliveryperson";
    synonym "peanuts" "packaging peanuts" "peanut";
    synonym "sign" "sign for" "sign clipboard" 
    "take clipboard" "take package" "sign things";
    synonym "door" "front door";
    synonym "talk" "say hello" "say hello to" "greet";
    synonym "hurt" "harm" "kick" "bite" "punch" "hit" 
    "slap" "kill" "stab" "murder";
    synonym "follow" "chase after" "chase" "run after";
    synonym "sign anyway" "sign with blood" "sign with your own blood";
    synonym "ask for" "request";
    synonym "ring doorbell" "push doorbell";
    synonym "consider" "contemplate";
    synonym "exit" "leave";

    command look {
        respond {
            You stand in the entryway of your
            apartment. From here you can access your bedroom,
            the kitchen, or the greater outside world,
            but the room itself is small, bare,
            and empty. You think this room should
            be a metaphor for something, but you're
            not quite sure what. The front door
            is `frontDoor`. Maybe also a metaphor.
        }
    }
    command exit {
        trigger go outside;
    }
    command talk {
        trigger talk woman;
    }
    command open door {
        if `eq frontDoor "open"` {
            respond {
                The door is alread open!
            }
        }
        else {
            set frontDoor "open";
            if `mailWomanPresent` {
                respond {
                    A young woman carrying a brown package
                    under her arm stands in the doorway,
                    holding a clipboard.

                    "You've got mail!" she says,
                    holding out a clipboard. "Please
                    sign for your package."
                }
                set openedDoorFirst 1;
            }
            else {
                if `gotPackageFromEmily` {
                    respond {
                        Strangely, no one is here. You can't
                        even spot a person walking
                        away or a car driving off. Strange.
                        Oh well. Package! Sometimes you feel
                        there is nothing more beautiful than a
                        cardboard package bearing your name
                        on the address. You double check the
                        address. Yes, this one actually does
                        have your name. You pick up the package.
                    }
                    set gotPackageFromEmily 0;
                    set hasYourPackage 1;
                    if `eq hintsState "yourPackage"` {
                        set hintsState "open2";
                        set hintsCounter 0;
                    }
                }
                else {
                    respond {
                        You open the door, which offers you a
                        portal into the cold, harsh, outside world.
                        There may be adventures to be had out there,
                        but the snow on the ground makes it clear that,
                        outside, there certainly isn't central heating.
                    }
                }
            }
        }
    }
    command sign {
        trigger sign package;
    }
    command consider metaphor {
        respond {
            It's a pretty good metaphor
        }
    }
    command steal clipboard {
        if `mailWomanPresent` {
            respond {
                You try distracting `mailPersonName` with the
                ageless look over there! tactic, but it doesn't seem to work.
                Oh well.
            }
        }
        else {
            respond {
                The woman is gone. You probably scared her away.
            }
        }
    }
    command steal package {
        trigger steal clipboard;
    }
    command ask for pen {
        if `mailWomanPresent` {
            respond {
                You politely inquire if you can have a pen. 
                Sadly, `mailPersonName` only smiles blnkly at you
                and tells you that it's against company policy to lend pens.
            }
        }
        else {
            respond {
                The woman is gone. You probably scared her away.
            }
        }
    }
    command demand package {
        if `mailWomanPresent` {
            respond {
                You make a strongly worded demand for that package
                and the material good it contains. "Protocols," says
                the woman, holding out her clipboard. You sigh.
            }
        }
        else {
            respond {
                The woman is gone. You probably scared her away.
            }
        }
    }
    command sign anyway {
        if `mailWomanPresent` {
            respond {
                You attempt to sign for the package using your
                own blood. However, `mailPersonName` takes away
                the clipboard, scolding you for using a nonstandard
                ink.
            }
        }
        else {
            respond {
                The woman is gone. You probably scared her away.
            }
        }
    }
    command follow woman {
        if `and (eq frontDoor "open") (not mailWomanPresent)` {
            respond {
                She's just too fast for you. She got away, taking all
                of her beautiful packages along with her.
            }
        }
        else {
            respond {
                Who are you chasing?
            }
        }
    }
    command hurt woman {
        if `mailWomanPresent` {
            respond {
                But `mailPersonName` brings you packages! You wouldn't
                want to hurt her!
            }
        }
        else {
            respond {
                There's no victim here for your violent outbreaks.
            }
        }
    }
    command sign package {
        if `or (eq frontDoor "closed") (not mailWomanPresent)` {
            respond {
                What package?
            }
        }
        else {
            if `hasPen` {
                respond {
                    With your BERT'S TREE TRIMMING pen, you sign
                    your name expertly on
                    the line just beneath where 
                    Mr. Robertson scrawled out
                    a neat signature of his own. You admire your work.
                    Unlike Mr. Robertson,
                    you've perfected your signature to the point
                    that even the most expert handwriting
                    analysts would not be able decipher your
                    actual name from all the ornamental loops
                    and crosses.
                    Then `mailPersonName` smiles and hands
                    you your package. Before you 
                    can thank her, she runs
                    off to her truck and drives away. You
                    suppose she couldn't have just stood around
                    waiting for you all day.
                }
                set hasOrigPackage 1;
                set mailWomanPresent 0;
                if `neq hintsState "open1"` {
                    set hintsState "open1";
                    set hintsCounter 0;
                }
            }
            else {
                respond {
                    You don't have a pen. You would think
                    the woman would provide you with a pen,
                    but she does not seem to care about
                    your human needs.
                }
                if `eq hintsState "mail"` {
                    set hintsState "pen";
                    set hintsCounter 0;
                }
            }
        }
    }
    command talk woman {
        if `or (not mailWomanPresent) (eq frontDoor "closed")` {
            respond {
                You don't see anyone to talk to.
            }
        }
        else {
            respond {
                You open your mouth to speak. Presumably,
                your mouth can form semi-intelligible words
                that may be accurately interpreted by
                the woman in front of you. What would you like to say?
                 
                (say 1) Nice to meet you!
                 
                (say 2) May I borrow a pen?
                 
                (say 3) Bow down to me, mortal!
            }
        }
    }
    command talk mailman {
        if `or (not mailWomanPresent) (eq frontDoor "closed")` {
            respond {
                You don't see anyone to talk to.
            }
        }
        else {
            respond {
                This is not a mailman, this is a mailwoman!
                Do you have some gender identification issues?
            }
        }
    }
    command 1 {
        if `mailWomanPresent` {
            respond {
                At first, `mailPersonName` appears startled that
                you have responded to her presence
                with a cordial greeting,
                as if you see her as an actual human
                being and not just a convenient outside-world-to-home
                delivery system for packages. But
                she closes her mouth and recovers quickly.
                
                "Nice to meet you too," she says.
                "My name is Patty. You've got mail!"
                
                You nod in agreement. 
            }
            set mailPersonName "Patty";
        }
        else {
            respond {
                There's no one around. You're
                just talking to yourself again.
            }
        }
    }

    command 2 {
        if `mailWomanPresent` {
            respond {
                In response, `mailPersonName` checks her pockets,
                which appear to be empty.
                "Sorry," she says. "Lending customers
                objects is against company standards.
                Please sign for your package."

                Well, that makes sense, but you still need a pen.
            }
            if `eq hintsState "mail"` {
                set hintsState "pen";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                There's no one around. You're
                just talking to yourself again. 
            }
        }
    }
    command 3 {
        if `mailWomanPresent` {
            respond {
                After looking at you, `mailPersonName` sighs
                heavily. "May I check your post office
                membership card?" she asks.
                You check your pockets, but find nothing
                that could help you in this situation.
                As far as you know, you are not a member of
                the esteemed post office club.
                
                "I only bow down to members of the
                post office club," she says. "Maybe after you order a
                few more packages you'll get your membership card."
            }
        }
        else {
            respond {
                There's no one around. You're
                just talking to yourself again. 
            }
        }
    }

    command close door {
        if `eq frontDoor "closed"` {
            respond {
                The door is alread closed.
            }
        }
        else {
            set frontDoor "closed";
            if `mailWomanPresent` {
                respond {
                    You politely close the door in the `mailPersonName`'s face. She doesn't
                    seem to mind, and makes no indication that she will leave. After all, she has
                    your package.
                }
            }
            else {
                respond {
                    You close the door, sealing yourself
                    away from all sunshine and fresh air.
                    Actually, it's cold and snowy outside.
                    You aren't missing much.
                }
            }
        }
    }
    command eat peanuts {
        trigger take peanuts;
    }
    command look peanuts {
        if `origPackageOpen` {
            respond {
                The intense butchering of the cardboard
                left a splattering of packaging
                peanut entrails across the floor of your entryway.
            }
        }
        else {
            respond {
                Peanuts! But you can't see any.
            }
        }
    }
    command take peanuts {
        if `origPackageOpen` {
            respond {
                Unlike their nut relatives, packaging
                peanuts are not edible and are 
                therefore of little interest to you.
            }
        }
        else {
            respond {
                Peanuts! But you can't see any.
            }
        }
    }
    command go living-room {
        if `openedDoorFirst`{
            if `hasOrigPackage` {
                respond {
                    Your mind is singularly focused on the
                    package and its contents.
                    You are temporarily unaware that any world
                    exists outside of the universe of you
                    and your package.
                }
            }
            else{
                #set frontDoor "closed";
                move-to living-room;
                trigger look;
            }
        }
        else {
            respond {
                Package package package!
            }
        }
    }
    command go kitchen {
        if `openedDoorFirst`{
            if `hasOrigPackage` {
                respond {
                    Your mind is singularly focused on
                    the package and its contents.
                    You are temporarily unaware that
                    any world exists outside of the universe
                    of you and your package.
                }
            }
            else{
                #set frontDoor "closed";
                move-to kitchen;
                trigger look;
            }
        }
        else {
            respond {
                Package package package!
            }
        }
    }
    command go bedroom{
        if `openedDoorFirst`{
            if `hasOrigPackage` {
                respond {
                    Your mind is singularly focused on the
                    package and its contents.
                    You are temporarily unaware that any
                    world exists outside of the universe
                    of you and your package.
                }
            }
            else {
                #set frontDoor "closed";
                move-to bedroom;
                trigger look;
            }
        }
        else {
            respond {
                Package package package!
            }
        }
    }
    command go bathroom{
        if `openedDoorFirst`{
            if `hasOrigPackage` {
                respond {
                    Your mind is singularly focused on the
                    package and its contents.
                    You are temporarily unaware that
                    any world exists outside of the
                    universe of you and your package.
                }
            }
            else {
                #set frontDoor "closed";
                move-to bathroom;
                trigger look;
            }
        }
        else {
            respond{
                Package package package!
            }
        }
    }
    command go outside{
        if `and mailWomanPresent (eq frontDoor "open")` {
            respond {
                It seems rude to just walk past `mailPersonName`
                while she is trying to
                deliver your package. Who knows how long she
                will stand there, waiting for you to sign?
            }
        }
        else {
            if `eq frontDoor "closed"` {
                respond {
                    The front door is closed. How can you
                    ever go outside?
                }
            }
            else {
                if `returnedEmilyPackage` {
                    respond {
                        You really have no desire to leave your
                        house even one more time today. You're
                        going to stay right here even if the world
                        crumbles around you. Especially if the world
                        crumbles around you.
                    }
                }
                else {
                    if `hasOrigPackage` {
                        respond {
                            Your mind is singularly focused on the
                            package and its contents.
                            You are temporarily unaware that
                            any world exists outside of the
                            universe of you and your package.
                        }
                    }
                    else {
                        respond {
                            Ah, the great outdoors. As freezing cold
                            and inhospitable as ever.
                            To be honest, standing outside
                            in the middle of winter staring vacantly into
                            space is not one of your favorite
                            activities. Being inside would be much better.
                            Your car is sitting in the driveway,
                            waiting. Good car.
                        }
                        set frontDoor "closed";
                        move-to outdoors;
                    }
                }
            }
        }
    }
    command go post office {
        respond {
            Your car is outside. You might want to use it.
        }
    }
    command take doorbell {
        respond {
            The doorbell is outside. You can't actually access it here.
        }
    }
    command ring doorbell {
        trigger take doorbell;
    }
    object doorbell {
        You can hear it inside, even though it's located outside.
        It's kind of magic.
    }
}

location kitchen house {

    synonym "stove" "stains" "oven" "stain";
    synonym "food" "loaf of bread" "bread" "empty box of pasta" 
    "pasta" "cookies";
    synonym "tomato-sauce" "tomato sauce" "tomatosauce";
    synonym "food" "bread" "pasta" "cookies";
    synonym "take" "eat";
    synonym "fridge" "refrigerator" "fridge door" "refrigerator door";
    synonym "cheese" "take out boxes" "boxes";
    synonym "butter"  "little butter dish thing" 
    "butter dish thing" "butter dish";
    synonym "jars" "jar" "jam" "jams" "marmalade" "condiments";
    synonym "clean" "wash";
    synonym "dishes" "plates" "plate" "dish";
    synonym "shelves" "fridge shelves";
    synonym "counter" "counters" "counter top" "counter tops";
    synonym "kill" "destroy" "remove";
    synonym "smell" "smell room";
    synonym "dinosaur" "triceratops";
    synonym "take breakfast" "make breakfast";
    
    command look {
        respond {
            Your kitchen looks exceptionally clean today. 
            Last night you remembered to put all of the
            perishable food back in the refrigerator
            that's in the corner of the room, so it 
            smells better than usual as well. You only
            have half of the pantry spread out across the counters 
            in an elaborate pyramid of food, and
            these are the food items that are convenient to have 
            right beside you. Well, most of them.
            The stove only has three major stains, and two of them are
            never coming off, so it's not fair
            to count those. The sink might be overflowing with dishes,
            but you still have one or two clean plates,
            and who needs more than that?

            The kitchen exits into the living room.
        }
    }
    command exit {
        trigger go living room;
    }
    command find sponge {
        respond {
            You know it's somewhere beneath the dirty dishes.
            You consider that found.
        }
    }
    command smell {
        respond {
            Delicious. Or, at least it doesn't smell much like
            rotting food.
        }
    }
    command clean {
        respond {
            Cleaning the entire kitchen is way too imposing
            of a task for you to even contemplate. Besides, it's
            kind of clean.
        }
    }
    command clean stove {
        respond {
            You look for a sponge, but it's probably 
            somewhere underneath the pile of dishes,
            and it's not time to clean the dishes yet.
            You still have a couple of clean plates left.
        }
    }
    command clean kitchen {
        respond {
            That sounds way too difficult. You're pretty sure
            you can't muster up the motivation to clean a plate.
        }
    }
    command dirty dishes {
        respond {
            You have enough dirty dishes. Let's keep the
            clean ones clean so you don't have to make
            the dirty ones clean.
        }
    }
    command clean dishes {
        respond {
            Why would you waste your time washing
            dishes when you have clean plates?
        }
    }
    command take breakfast {
        respond {
            You've heard that breakfast is the most
            important meal of the day. So it's probably important
            in some way that you slept through breakfast.
        }
    }
    command take lunch {
        respond {
            That sounds like way too much work.
        }
    }
    command take dinner {
        respond {
            It's not dinner time now. You hope you have enough
            energy to make food when you're hungry.
        }
    }
    command take food {
        respond {
            Everything is balanced as such a perfect
            structure that it would be a shame to move anything.
        }
    }
    command look fridge {
        if `fridgeOpen` {
            respond {
                You've got a kind of fossil record going on here. 
                Layers of food from different time periods. 
                The immediately accessible layer is comprised mostly of
                take out boxes and cheese. Just the necessities. 
                At least the shelves on the door are easily accessible.
            }
        }
        else {
            respond {
                Your fridge is closed. On some people's fridges, they
                proudly display cute pictures drawn by their 
                four-year-olds alongside the
                report card pronouncing the mediocre achievements of
                their middle schooler. But you don't have and kids.
                And if you did, you certainly wouldn't want to show off
                whatever monstrosity you brought forth into the world.
                So your refrigerator door is empty.
            }
        }
    }
    command close fridge {
        if `not fridgeOpen` {
            respond {
                The fridge is already closed.
            }
        }
        else {
            set fridgeOpen 0;
            respond {
                You close the refrigerator. 
                You'd prefer to avoid an excessive electricity bill 
                this month.  Unlike last month, when you tried to 
                incubate that alligator egg with all of those heat 
                lamps. Everything about that was a mistake
            }
        }
    }
    command take dishes {
        respond {
            You have no dire need for dishes right now.
            Your hands have always served you quite well.
        }
    }
    command open fridge {
        if `fridgeOpen` {
            respond {
                The fridge is open. That's why it's so cold in here.
            }
        }
        else {
            set fridgeOpen 1;
            trigger look fridge;
        }
    }
    command clean fridge {
        if `not fridgeOpen` {
            respond {
                The door is alread completely clean of garbage like
                stupid kid pictures.
            }
        }
        else {
            respond {
                The prospect of undertaking any kind of excavation 
                fills you with a vague sense of dread and guilt. 
                Not now, you think.
                
                If "not now" were a mantra repeated to reanimate 
                the dead or summon demons, your apartment would be full 
                to bursting with the recently resurrected and/or 
                unspeakably horrible monsters. Good thing it's not.  
            }
        }
    }
    command take cheese {
        if `fridgeOpen` {
            trigger clean fridge;
        }
        else {
            respond {
                Where?
            }
        }
    }
    command look cheese {
        if `fridgeOpen` {
            respond {
                A bit of cheese next to some old take out boxes.
                Indisputable proof of your ability to feed yourself.
            }
        }
        else {
            respond {
                Where?
            }
        }
    }
    command look shelves {
        if `fridgeOpen` {
            respond {
                 All of your jams and condiments are just so. 
                 Arranging jars of marmalade is an art you take 
                 seriously. You have spent a lot of time moving 
                 these jars around because you really dislike 
                 throwing them out. What would usually be 
                 termed "empty" is to you merely a challenge. 
                 Needless to say you are an expert at scraping 
                 marmalade dregs from jars. At the top of the 
                 shelf is the little butter dish thing. It's closed. 
                 You wonder if there is a formal name for the 
                 little butter dish thing. 
            }
        }
        else {
            respond {
                Shelves? Like those things used for organization? Ha.
            }
        }
    }
    command look butter {
        if `fridgeOpen` {
            respond {
                A little butter dish thing. You're not quite sure
                how you could be more descriptive than that. It's white
                and plastic, and like most little butter dish things,
                the lid comes all the way off.
            }
        }
        else {
            respond {
                What are you talking about?
            }
        }
    }
    command take keys {
        if `hasKeys` {
            respond {
                They're already in your pocket.
            }
        }
        else {
            respond {
                Did you check the fridge? They might be in there.
            }
        }
    }
    command look jars {
        if `fridgeOpen` {
            respond {
                A perfect arrangement made by a perfect person.
                (That's referring to you, in case it wasn't clear.)
            }
        }
        else {
            respond {
                What are you talking about?
            }
        }
    }
    command take jars {
        if `fridgeOpen` {
            respond {
               No! Don't touch the perfect arrangement!
            }
        }
        else {
            respond {
                What are you talking about?
            }
        }
    }
    command take butter {
        if `fridgeOpen` {
            if `hasKeys` {
                respond {
                    There wasn't actually any butter in
                    there, remember?
                    Yum butter...
                }
            }
            else {
                respond {
                    You're not positive there's actually butter inside
                    of that. Come to think of it, you can't remember
                    the last time you bought butter. You sure hope
                    there isn't butter inside of that.
                }
            }
        }
        else {
            respond {
                What are you talking about?
            }
        }
    }
    command open butter {
        if `hasKeys` {
            respond {
                It's empty.
            }
        }
        else {
            respond {
                Your keys! Just where they always are.
                
                You stash the keys in your jacket pocket.
            }
            set hasKeys 1;
            if `eq hintsState "keys"` {
                set hintsState "post";
                set hintsCounter 0;
            }
        }
    }
    command close butter {
        if `hasKeys` {
            respond {
                Your butter dish is closed, waiting until your
                next need to store your keys.
            }
        }
        else {
            respond {
                The dish is already closed.
            }
        }
    }
    command take steve {
        respond {
            Steve is a stain, and therefore can only exist on
            the stove. To move Steve would mean Steve's death.
        }
    }
    command kill steve {
        respond {
            That would involve cleaning the stove, which sounds
            really difficult.
        }
    }
    command kill stove {
        respond {
            That would involve cleaning the stove, which sounds
            really difficult.
        }     
    }
    command make food {
        respond {
            Now, you know you are a responsible adult, but being able to
            make food goes way beyond responsibility and into insanity.
            You're not going that far.
        }
    }
    command pet steve {
        respond {
            You fondly pat Steve.
        }
    }
    object stove {
        Three stains artfully decorate your stove.
        The one in the shape of a dinosaur has been
        there since before you can remember, and
        you fondly refer to the one near the back left
        burner as Steve. The tomato sauce stain
        across the entire front of the stove is
        a more recent acquisition.
    }
    object steve {
        Steve has been with you from the
        day you spilled a failed attempt
        at a cream sauce and refused to clean it up for a month.
    }
    object dinosaur {
        A stain in the shape of a triceratops.
        You've forgotten what artful substance
        created it; it just looks sort of blackish now.
    }
    object tomato-sauce {
        You made this stain only two days ago.
        You could probably remove it with some
        scrubbing, but that sounds like work.
    }
    object sink {
        That's a lot of dirty dishes. Luckily,
        you have enough plates and silverware
        to feed about twenty.
        Also lucky, you never have guests.
        Guests. That's a terrifying thought.
        Please don't invite anyone into this
        apartment, ok? Anyway, you have dishes to spare,
        so don't worry about cleaning these.
    }
    object dishes {
        That's a lot of dirty dishes. Luckily, you
        have enough plates and silverware to
        feed about twenty.
        Also lucky, you never have guests.
        Guests. That's a terrifying thought.
        Please don't invite anyone into
        this apartment, ok? Anyway, you have dishes to spare,
        so don't worry about cleaning these.
    }
    object food {
        It's just masterful how that stale
        loaf of bread balances on an empty box of
        pasta and a package of cookies.
    }
    object pantry {
        It's pretty sparse, probably since the counters
        hold half of its contents.
    }
    object counter {
        You can't actually see the counter top because of the food,
        but you're pretty sure its there.
    }
    object sponge {
        It's somewhere beneath the dirty dishes. You can't see
        it right now. That might be a good thing. 
    }
    object pictures {
        Your fridge is tankfully free of little kid pictures.
    }
}

location bathroom house {
    synonym "clean" "wash" "rinse";
    synonym "tile" "floor" "tiles" "tile floor";
    synonym "take shower" "turn on shower" "turn on water"
    "open shower" "use shower";
    synonym "clean room" "clean shower" 
    "clean mirror" "clean toilet" "clean sink";
    synonym "sweatshirt" "sweater" "mat";
    synonym "clothes" "clothing";
    synonym "look" "look in";
    synonym "room" "bathroom";

    command look {
        respond {
            It's a bathroom. What did you expect? You see typical 
            bathroom things like a toilet, sink, shower, mirror, 
            and dirty clothes on the floor.
            The bathroom leads into the living room.
        }
    }
    command exit {
        trigger go living room;
    }
    command dry hands {
        respond {
            You have no idea where the towels went, if you 
            ever had any.
        }
    }
    command open toilet {
        respond {
            It's open already. Why would it not be?
        }
    }
    command close toilet {
        respond {
            Why would you close it? You really don't understand
            why these things close anyway.
        }
    }
    command take sink {
        respond {
            You dig your nails into the sides of the sink,
            but it doesn't detatch. In retrospect, that's
            probably a good thing. You don't want to deal with
            that kind of plumbing mess.
        }
    }
    command flush toilet {
        respond {
            The water whirls down the drain in pretty spirals.
            You contemplate the ingenuity of the toilet's design.
        }
    }
    command use toilet {
        respond {
            You really have no pressing need to use the toilet right now.
        }
    }
    command wear clothes {
        respond {
            Why would you wear your bath mat?
        }
    }
    command open mirror {
        respond {
            This isn't the type of mirror that opens. You try
            to pry it open anyway, but all you get is a reflection
            of you looking like an idiot trying to open the mirror.
        }
    }
    command turn on sink {
        trigger clean hands;
    }
    command wear sweatshirt {
        trigger wear clothes;
    }
    command take toilet {
        respond {
            You're pretty sure that isn't portable.
        }
    }
    command take mirror {
        respond {
            As much as you love staring at your perfect reflection,
            that mirror isn't coming off the wall.
        }
    }
    command clean hands {
        respond {
            You put your hands under the sink and turn on the tap.
            Water pours over your hands. You turn off the tap. 
            Your hands are clean now, right?
        }
    }
    command take shower {
        respond {
            You turn on the showerhead, spraying yourself with a 
            stream of water. Good job. We are all so proud. 
            You turn off the water.
        }
    }
    command take clothes {
        respond {
            That pile of clothes is exactly where is should be. 
            You don't want to move your perfectly formed bath mat.
        }
    }
    command clean {
        trigger clean room;
    }
    command clean room {
        respond {
            This is the room where you go to get cleaned.
            You don't have to clean it, it cleans you!
        }
    }
    command clean clothes {
        trigger take clothes;
    }
    command take sweatshirt {
        trigger take clothes;
    }
    command clean sweatshirt {
        trigger take clothes;
    }
    command stare at reflection {
        respond {
            Your reflection stares back at you.
        }
    }
    object clothes {
        A pile of dirty clothes cushion the hard, tile floor. 
        An especially fluffy sweater sits on top, 
        acting as the perfect bath mat for the rare occasion 
        that you would actually use one.
    }
    object sweatshirt {
        Green, fluffy, and perfect for your feet.
    }
    object floor {
        Kind of hard to see beneath all the dirty clothes. You think
        you spot a tile somewhere over there.
    }
    object toilet {
        Really? Why?
    }
    object shower {
        The thing you stand under to become clean. Slightly underused.
    }
    object sink {
        Kind of grimy. May or may not make hands cleaner.
    }
    object mirror {
        You see your reflection staring blankly back at you.
    }
    object reflection {
        You, perfect in all your imperfections.
    }
}

location living-room house {
    synonym "couch" "sofa" "loveseat";
    synonym "dust" "dust bunny" "dust bunnies";
    synonym "cushion" "couch cushions" "couch cushion" "cushions";
    synonym "leg" "legs" "desk legs";
    synonym "read words" "read paper" "read papers";
    synonym "computer" "desktop";
    synonym "monitor" "screen";
    synonym "take computer" "take desktop" "take mouse" 
    "take monitor" "take keyboard";
    synonym "turn on tv" "watch tv" "play tv" "turn tv on";
    synonym "open" "navigate" "navigate to" "click on" "click";
    synonym "swifts" "browser" "internet" "the internet" 
    "google" "swiftscom";
    synonym "pen" "pens" "giant pen" "giant pens";
    synonym "something" "anything" "random item" 
    "random thing" "stuff";
    synonym "gap" "under couch";
    synonym "close" "leave" "exit";
    synonym "chat" "talk" "chatroom" "chat room";
    synonym "quarter" "coin" "money";
    synonym "sit" "sit on" "relax" "relax on" "lay" "lay on";
    synonym "tv" "television";
    synonym "browse" "search" "explore" "scroll through";
    synonym "buy" "purchase";
    synonym "baby clothes" "onesie";
    synonym "explosives" "bomb" "bombs" "dynamite";
    synonym "emoticon" "smiley" "smiley face";
    synonym "legs" "leg" "desk legs" "desk leg";
    synonym "q" "q key";
    synonym "everything" "all of things" "all things" "all";
    synonym "marker" "markers" "scented markers" "scented marker";
    synonym "armchair" "chair" "florid armchair" "florid chair";
    synonym "soap" "bar of soap" "bars of soap" "soap bar"
    "soap bars" "bar soap" "bars soap";
    synonym "sleep" "sleep on couch" "sleep couch" "nap on couch" 
    "nap couch" "nap";
    synonym "go cushion" "look between cushion";
    synonym "remote" "remote control";
    synonym "look" "find" "look for" "browse for" 
     "browse through" "look through" "browse";
    synonym "turn on computer" "turn computer on" 
    "press on button" "press on" "push on button";
    synonym "turn off computer" "turn computer off"
    "press off button" "press off" "push off button";
    synonym "caress" "stroke";
    synonym "sales" "other sales";
    synonym "hello" "hi";
    synonym "fraud" "online identify fraud" 
    "identity fraud" "online fraud";

    command look {
        respond {
            The living room lies in the center of the apartment,
            as if it were the center of a community, and that 
            community consisted only of you. From here you 
            can reach the bedroom, bathroom, entryway, and kitchen.
            
            A rather comfortable couch stands along one wall 
            and a chair and desk with a computer lean against 
            the other wall. A TV stands in the center of the 
            room, an island of reality shows and sports games 
            that you don't have to participate in.
        }
    }
    command look sales {
        trigger browse swifts;
    }
    command caress cushions {
        respond {
            You stroke the cushions lovingly.
        }
    }
    command go computer {
        if `eq computerState "off"` {
            trigger turn on computer;
        }
        else {
            respond {
                You walk over to the computer
            }
        }
    }
    command go cushion {
        respond {
            You find nothing of interest between the cushions.
            They're really soft and cuddly, though.
        }
    }
    command caress cushion {
        respond {
            You run your hand over the soft, soft cushion.
        }
    }
    command use computer {
        trigger turn on computer;
    }
    command exit {
        trigger go bedroom;
    }
    command take dust {
        respond {
            Your house has enough dust already. 
            Let's keep this dust where it belongs, right here.
        }
    }
    command open desk {
        respond {
            The desk doesn't have any draers. Or, if it was supposed
            to, you forgot to assemble them. Either way, it doesn't open.
        }
    }
    command love dust bunnies {
        respond {
            You already love anything with bunny in its name.
        }
    }
    command go desk {
        respond {
            You walk over to your desk.
        }
    }
    command buy {
        respond {
            Swifts! Swifts! Swifts! Buy! Buy! Buy!
        }
    }
    command take quarter {
        respond {
            That's your laundry money and you don't want to do 
            laundry now, so let's just leave it there until you run 
            out of clean clothes.
        }
    }
    command sit couch {
        respond {
            Comfy! You yawn, stretch out your arms, 
            and caress the soft cushions. Then you get up again.
        }
    }
    command sleep {
        respond {
            You spread yourself across the couch like a model.
            A sleepy model. Then you remember that you just
            woke up. You stand back up.
        }
    }
    command read words {
        trigger look words;
    }
    command take papers {
        respond {
            You don't want to think about those papers. 
            Just keep them on the desk where you can forget about
            them until they're so late they don't matter anymore.
        }
    }
    command take computer {
        respond {
            It's a desktop, so it goes on your desk, not your lap.
        }
    }
    command sit armchair {
        respond {
            You sit in the chair a swivel around a few times before
            getting back up.
        }
    }
    command turn on computer {
        if `eq computerState "off"` {
            set computerState "on";
            respond {
                The computer takes about a minute to turn on, 
                during which time you stare at the screen, 
                waiting for the bright lights to flash at your face. 
                The desktop loads, showing you two shortcuts on your
                screen: one to the internet chatroom and one to your
                favorite online store, Swifts.
            }
        }
        else {
            respond {
                Your computer is already on. That's why all those
                bright lights are flashing in your face.
            }
        }
    }
    command turn off computer {
        if `eq computerState "on"` {
            set computerState "off";
            set onSwifts 0;
            set onChat 0;
            respond {
                All the bright, pretty colors of the monitor fade to
                black. By fade we mean instantly vanish from existence,
                and where the once was brightness, light, joy, and
                meaning, now there is none. Such is life. At least
                there's still the TV.
            }
        }
        else {
            respond {
                Your computer is already off. At least, you think
                that's why the screen is black and doesn't respond
                when you click the mouse two hundred times.
            }
        }
    }
    command turn on tv {
        respond {
            It would be so great to watch TV right now. Just sit on
            the couch and do nothing. What a life. You don't
            know where they remote is, though, and finding it seems
            like so much effort.
        }
    }
    command turn off tv {
        respond {
            You're pretty sure your TV is off. Or maybe it's broken!
            That would be the worst.  Where would you watch your
            football games? What would you do with yourself?
            no, you're pretty sure it's just off.
        }
    }
    command type q {
        respond {
            That's rather difficult since you keyboard doesn't
            have a q.
        }
    }
    command go swifts {
        trigger open swifts;
    }
    command go chat {
        trigger open chat;
    }
    command open swifts {
        if `eq computerState "off"` {
            respond {
                You first turn on your computer, because you
                hear that helps.
            }
            set computerState "on";
        }
        respond {
            You open to swifts.com. Man, you love this store.
            Right now giant pens are on sale for half price!
        }
        set onSwifts 1;
    }
    command use swifts {
        trigger open swifts;
    }
    command open swifts {
        if `eq computerState "off"` {
            respond {
                You first turn on your computer, because you
                hear that helps.
            }
            set computerState "on";
        }
        respond {
            A beutiful store full of beautiful things.
        }
    }
    command commit fraud {
        if `eq computerState "off"` {
            respond {
                You first turn on your computer, because you
                hear that helps.
            }
            set computerState "on";
        }
        respond {
            You steal the identies of five different people and
            use their credit cards to buy presents for each other on
            Swifts.com.
        }
    }
    command buy pen {
        if `onSwifts` {
            respond {
                That price is tempting, but you resist 
                the temptation.
                You know how to practice self control when it comes 
                to purchasing items online.
            }
        }
        else {
            respond {
                I bet Swifts sells those! You should check!
            }
        }
    }
    command buy everything {
        if `onSwifts` {
            respond {
                You start placing things in your cart. A bar 
                of soap, a florid armchair, some scented markers...

                After the 137th item, your arm gets a little tired and
                the price tag on your cart is frightening. You cancel
                all of your purchases.
            }
        }
        else {
            respond {
                Swifts sells everything! You should buy it all of
                everything there!
            }
        }
    }
    command buy soap {
        if `onSwifts` {
            respond {
                You're very conservative about soap usage,
                so that bar you bought last year is less than halfway
                gone. You don't need another one right now.
            }
        }
        else {
            respond {
                I bet Swifts sells those! You should check!
            }
        }
    }
    command buy armchair {
        if `onSwifts` {
            respond {
                The armchair looks pretty nice, but the upholstery clashes
                with the pattern of the dirty laundry on your floor.
            }
        }
        else {
            respond {
                I bet Swifts sells those! You should check!
            }
        }
    }
    command buy marker {
        if `onSwifts` {
            respond {
                The yellow one smells like lemon!
                The blue one smells like raspberries! You are
                confused why some people think raspberries are blue,
                which is enough to keep you from buying these markers.
            }
        }
        else {
            respond {
                I bet Swifts sells those! You should check!
            }
        }
    }
    command look swifts {
        if `onSwifts` {
            respond {
                The baby clothes look really cute. 
                Too bad you don't have a child, have any desire
                to have a child, know anyone with a child, or have
                any desire to know anyone with a child.
            }
        }
        else {
            respond {
                You should go on Swifts and see what they're selling!
            }
        }
    }
    command buy baby clothes {
        if `onSwifts` {
            respond {
                That yellow onesie with an orange duckbill 
                on the top of the hood probably wouldn't fit you.
            }
        }
        else {
            respond {
                I bet Swifts sells those! You should check!
            }
        }
    }
    command buy something {
        if `onSwifts` {
            respond {
                Sadly, Swifts recently disabled the Random Buy!
                button after they ended up shipping a crate of
                explosives to a nursing home
            }
        }
        else {
            respond {
                You love to buy things! Maybe Swifts is selling something
                interesting today!
            }
        }
    }
    command buy explosives {
        if `onSwifts` {
            respond {
                Swifts' license for selling explosives was 
                recently revoked.
            }
        }
        else {
            respond {
                I bet Swifts sells those! You should check!
            }
        }
    }
    command buy teapot {
        if `onSwifts` {
            respond {
                You have some vague memory of buying a
                teapot at some point. Kind of odd, but it
                makes you feel like you shouldn't buy one
                right now, just in case.
            }
        }
        else {
            respond {
                I bet Swifts sells those! You should check!
            }
        }
    }
    command buy tea {
        if `onSwifts` {
            if `hasTeapot` {
                respond {
                    The fifty pound bag of tea is currently a dollar 
                    off today! What a great purchase. You click the Buy
                    Now! button, confident that, this time, your 
                    package will arrive safely to your doorstep. 
                    But that day is still a little while off. For 
                    now, you're satisfied with your successful day's 
                    work.
                    
                    Congratulations! You've won!
                }
                set hintsState "won";
                set hintsCounter 0;
            }
            else {
                respond {
                    You don't really need tea. You don't even 
                    own a teapot. Silly you.
                }
            }
        }
        else {
            respond {
                I bet Swifts sells those! You should check!
            }
        }
    }
    command buy * {
        if `onSwifts` {
            respond {
                Man, you really want to buy that, but
                you have a lot of self restraint, which you are
                demonstrating really well.
            }
        }
        else {
            respond {
                I bet Swifts sells that! You should check!
            }
        }
    }
    command close swifts {
        if `onSwifts` {
            respond {
                You close your browser, bringing you back to 
                the desktop with its icons for Swifts and the
                internet chatroom.
            }
            set onSwifts 0;
        }
        else {
            respond {
                You aren't even on Swifts. Why aren't you on Swifts?
                Swifts has so many great things!
            }
        }
    }
    command open chat {
        if `onChat` {
            respond {
                You're already on chat. Look! Emily wants to talk to
                you!
            }
        }
        else {
            if `eq computerState "off"` {
                respond {
                    You first turn on your computer, because you
                    hear that helps.
                }
                set computerState "on";
            }
            set onChat 1;
            respond {
                Emily is online! She says "hi!" with one of 
                those emoticons with an inscrutable expressions.
            }
        }
    }
    command chat {
        if `onChat` {
            trigger chat emily;
        }
        else {
            trigger open chat;
        }
    }
    command play game {
        if `eq computerState "off"` {
            respond {
                You first turn on your computer, because you
                hear that helps.
            }
            set computerState "on";
        }
        respond {
           You move a blocky worm thing around a screen collecting
           more blocks. You score 17 points!
        }
    }
    command close chat {
        if `onChat` {
            respond {
                You exit the chat room without saying any
                farewells to Emily. That was kind of rude.
            }
            set onChat 0;
            set chatEmily 0;
        }
        else {
            respond {
                You aren't even on chat. Just how much do you
                not want to interact with other humans or their
                chatroom counterparts?
            }
        }
    }
    command look emoticon {
        if `onChat` {
            respond {
                One eye appears to be closed while the other is 
                open. It might be smiling, or maybe just grimacing.
                It's difficult to tell.
            }
        }
        else {
            respond {
                You don't see an emoticon, but you sure are smiling!
            }
        } 
    }
    command look emily {
        if `onChat` {
            respond {
                Well, Emily is on chat, so you can't actually see her.
                Her avatar is a cute picture of a kitten, though.
            }
        }
        else {
            respond {
                Emily isn't here. She's probably on chat, though!
            }
        } 
    }
    command look kitten {
        if `onChat` {
            respond {
                Such a cute kitten. So, so fluffy. You wonder just
                how Emily might have aquired a picture of such a
                cute kitten.
            }
        }
        else {
            respond {
                Kittens? Kittens! You see no kittens, sadly.
            }
        } 
    }
    command say hello {
        if `onChat` {
            trigger 1;
        }
        else {
            trigger hello;
        }
    }
    command respond emily {
        trigger chat emily;
    }
    command ignore emily {
        respond {
            Sadly, you don't actually have any other friends
            on chat.
        }
    }
    command chat emily {
        if `onChat` {
            set chatEmily 1;
            respond {
                What would you like to say?
                
                (say 1) "hi! ;)"
                
                (say 2) "Who are you?"
                
                (say 3) "What's up?"
                
                (say 4) "Man, I wish something interesting would happen in this town."
                
                (say 5) "g2g! ttyl!"
            }
            if `and returnedEmilyPackage (not (or hasTeapot hasYourPackage))` {
                respond {
                    (say 6) "Hey, your package was sent to 
                    the wrong house. I put it on your doorstep."
                }
            }
        }
        else {
            respond {
                Emily isn't here. She's probably on chat, though!
            }
        } 
    }
    command hello emily {
        trigger 1;
    }
    command 1 {
        respond {
            You type in "hi" with an appropriate emoticon. 
            Your emoticon appears merely as a generic winky 
            face, and you wonder just how Emily manages to 
            portray a sophisticated range of emotions through
            this medium.
            
            She responds with another emoticon. This face 
            looks slightly more happy and has both eyes open.
        }
        trigger chat emily;
    }
    command 2 {
        if `chatEmily` {
            respond {
                "I'm Emily" she responds to your inquiry. 
                The additional piece of information is incredibly
                useful since, above you, the chat box displays
                the message "Emily saysâ€¦" But she continues,
                saying, "I live in the apartment next to you. 
                Don't you remember? You should come visit me. 
                That would be ideal." You recall having known 
                this information before, but somehow you have
                no mental concept of Emily as a person outside
                of the virtual realm of your computer.
            }
            trigger chat emily;
        }
        else {
            respond {
                Who are you talking to? Yourself again?
                You should stop doing that. It makes everyone
                stare.
            }
        }
    }
    command 3 {
        if `chatEmily` {
            respond {
                You inquire about the status of her, to 
                which Emily responds, "Life is pretty ideal," 
                she types back. "I got to play video games all day."
                "That's cool," you respond.
            }
            trigger chat emily;
        }
        else {
            respond {
                Who are you talking to? Yourself again?
                You should stop doing that. It makes everyone
                stare.
            }
        }
    }
    command 4 {
        if `chatEmily` {
            respond {
                "Yeah, I know," Emily says. "Like if trashcans became
                sentient or something. That would be ideal."
            }
            trigger chat emily;
        }
        else {
            respond {
                Who are you talking to? Yourself again?
                You should stop doing that. It makes everyone
                stare.
            }
        }
    }
    command 5 {
        if `chatEmily` {
            respond {
                You type your farewell, and Emily responds 
                with an emoticon of a waving smiley face. 
                You wish you had that much control of your online 
                expressions. You close the chat room, bringing you
                back to the desktop.
            }
            set `chatEmily` 0;
            set `onChat` 0;
        }
        else {
            respond {
                Who are you talking to? Yourself again?
                You should stop doing that. It makes everyone
                stare.
            }
        }
    }
    command 6 {
        if `chatEmily` {
            if `and returnedEmilyPackage (not (or hasTeapot hasYourPackage))` {
                respond {
                    "Hey, that's funny," she responds. "I just got a package 
                    that was meant for you. I'll send it over and leave it
                    at your door!"
                }
                set gotPackageFromEmily 1;
                set frontDoor "closed";
                if `eq hintsState "chat"` {
                    set hintsState "yourPackage";
                    set hintsCounter 0;
                }
            }
            else {
                respond {
                    Emily seems very confused, judging by the string
                    of gibberish she left on the screen.
                }
            }
            trigger chat emily;
        }
        else {
            respond {
                Who are you talking to? Yourself again?
                You should stop doing that. It makes everyone
                stare.
            }
        }
    }
    object armchair {
        A pretty standard chair by your desk.
    }
    object couch {
        A couch with two cushions. It's called a loveseat by 
        some people, which you suppose is an accurate name 
        because you really love to sit on this seat, eating 
        snacks and watching TV all by yourself. The dark gap 
        of shadows between the bottom of the couch and the 
        floor might contain some terrifying monster if you 
        lived in a horror story.
    }
    object gap {
        No monster here, only a bunch of dust bunnies and a lost quarter.
    }
    object dust {
        Misnomer: these are not actually bunnies, 
        just clumps of dust that are not even alive. Disappointing.
    }
    object quarter {
        That's where last month's laundry money went!
    }
    object cushion {
        So, so cushy.
    }
    object chair {
        A sturdy wooden chair where you can sit while you 
        use the computer.
    }
    object desk {
        You're pretty sure it's a desk because of the four 
        wooden legs that hold it up from the floor, but the 
        surface is so covered in random papers and computer 
        that it's hard to know for sure.
    }
    object legs {
        Probably desk legs, definitely not spider legs.
    }
    object papers {
        Papers with words. Probably something about bills you 
        should pay or Christmas cards you should send to people 
        whose names you only remember because you have to send them 
        Christmas cards every year. You'll deal with that later.
    }
    object words {
        Words, words, words, you read. Except that's probably
        not what the words really say, because you don't want
        to actually read words.
    }
    object computer {
        A clunky old desktop with a small monitor, a mouse,
        and a keyboard. It's `computerState` right now.
    }
    object monitor {
        Kind of a small screen, but it lights up when
        you press the on button.
    }
    object keyboard {
        Your typical QWERTY keyboard, except the Q is missing, 
        so it's more of a WERTY keyboard. Q is a pretty 
        useless letter though, so you don't mind the limitations 
        imposed on you by a keyboard with no Q.
    }
    object q {
        It's gone. Q does not exist in the universe of this keyboard.
        It's sad how little that even matters.
    }
    object mouse {
        A two button mouse. It looks more like a large 
        beetle than a mouse if you had to compare your hardware 
        to living creatures.
    }
    object tv {
        The football game isn't on for another three hours.
        You're pretty sure your television is as disappointed
        by the wait as you are.
    }
    object remote {
        It's nowhere to be found. You'll probably find it two
        weeks later when you're looking through your fridge.
        Don't worry about it.
    }
}

environment outside global {
    synonym "make" "create";
    synonym "snowman" "snowperson" "snowwoman";
    synonym "angel" "snow angel";

    command make snowman {
        respond {
            You form the perfect snowman. It's just
            glorious. You have lots of fun with Mr. 
            Snowman. Then you knock it down.
        }
    }
    command make angel {
        respond {
            You lie in the fluffy but really cold snow
            flailing your arms. You try to get up in
            a way that would avoid getting 
            footprints all over you angel. Instead, you
            step on its face. Good job. Looking back on
            you creating, its more of a deformed mutant than
            a snow angel.
        }
    }
    object angel {
        A flock of beautiful snow angels decorate the ground
        everywhere you go. It's just that wonderful of a world.
    }
    object sky {
        Gray, gloomy, and cold.
    }
    object cloud {
        That cloud almost looks like a lump of plaster.
    }
}

# just outside the house
location outdoors outside {
    synonym "inside" "house" "indoors";
    synonym "drive car" "open car" "take in car";
    synonym "drive" "go" "drive to";
    synonym "emily"  "emilys house" 
    "emily house" "emilys place" "emilys";
    synonym "car" "vehicle";
    synonym "post office" "post-office" "postoffice";
    synonym "open door" "enter" "enter house" "enter door";
    synonym "drive inside" "open door" "enter" 
    "enter house" "enter door";
    synonym "knock" "knock on door" "knock at door" "knock door";
    synonym "address" "address on package" "package address"
     "mr robertson" "mr robertsons house"
    "robertsons house" "robertson" "13310 podwoic avenue";
    synonym "drive post office" "deliver package";

    command look {
        respond {
            Ah, the great outdoors. As freezing cold and inhospitable 
            as ever.To be honest, standing outside in the middle of 
            winter staring vacantly into space is not one of your 
            favorite activities. Being inside would be much better. 
            Your car is sitting in the driveway, waiting. Good car.
        }
    }
    command drive robertson {
        if `hasSeenAddress` {
            respond {
                The nice, responsive people at the 
                post office can get this package back for you. You
                should just talk to them instead.
            }
        }
        else {
            respond {
                Where are you trying to go?
            }
        }
    }
    # This is really sad. :( due to sad aliasing of "go"
    command drive inside {
        respond { 
            It's warm in there. Good idea.
        }
        move-to entryway;
        trigger look;
    }
    command drive entryway {
        respond { 
            It's warm in there. Good idea.
        }
        move-to entryway;
        trigger look;
    }
    command drive kitchen {
        respond { 
            It's warm in there. Good idea.
        }
        move-to kitchen;
        trigger look;
    }
    command drive bedroom {
        respond { 
            It's warm in there. Good idea.
        }
        move-to bedroom;
        trigger look;
    }
    command drive bathroom {
        respond { 
            It's warm in there. Good idea.
        }
        move-to bathroom;
        trigger look;
    }
    command drive living-room {
        respond { 
            It's warm in there. Good idea.
        }
        move-to living-room;
        trigger look;
    }
    command look car {
        respond {
            It has four wheels and it drives places. 
            This is exactly what you wanted in a car.
        }
    }
    command take car {
        respond {
            Unfortunately, the car is too big to fit in your pockets.
            Fortunately, you can fit in the car.
        }
    }
    command turn on car {
        trigger drive car;
    }
    command drive car {
        if `not hasKeys` {
            set triedCar 1;
            respond {
                You walk over the car and yank on the door handle.
                The door is locked. You search your pockets for keys, 
                unsuccessfully. You must have left them inside. 
                They're probably in the place where they always are.
            }
            if `eq hintsState "post"` {
                set hintsState "keys";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                You open the car door, insert the keys into the
                ignition, and hum for a while. Then you forget why
                you are sitting in a car. Did you ever know why you are
                sitting in a car? You remove the keys and exit the
                vehicle.
            }
        }
    }
    command drive somewhere {
        trigger drive car;
    }
    command drive swifts {
        respond {
            Swifts exists only in the ethereal world 
            of the internet. Your car does not yet have 
            the ability to take you to that magical land.
        }
    }
    command drive post office {
        if `not hasKeys` {
            trigger drive car;
        }
        else {
            if `and hasSeenAddress (not donePostOffice)` {
                respond {
                    You unlock the door and climb into your car. 
                    The entire world is within your reach. At least,
                    the part that you have enough gasoline to get to,
                    and that isn't on another continent. It's a shame
                    you're so single minded about getting to the post
                    office. 

                    You drive through the normal streets of your normal
                    town. The sky is bleak and threatening snow again.
                    Each house you pass looks somewhat like the one
                    before it, windows spilling orange light out onto
                    snowcovered yards. There must be happy, well 
                    adjusted people inside of all of those houses. 
                    They are probably having the grandest time, 
                    without you.

                    What a peaceful, ordinary town. You can't believe
                    how boring it is here.

                    You pull into the post office parking lot. The 
                    sound of snow crunching under your tires is 
                    extremely satisfying to you, and you consider 
                    backing up and driving forward several more times.
                    This is of course stupid, as so many of your 
                    ideas are. You park and get out of the car, then
                    enter the post office.
                }
                move-to postoffice;
                trigger look;
                if `eq hintsState "post"` {
                    set hintsState "attention";
                    set hintsCounter 0;
                }
            }
            else {
                respond {
                    You have no reason to go to the post office.
                    They should send stuff to you! That's what
                    they're good for.
                }
            }
        }
    }
    command drive emily {
        if `not hasKeys` {
            trigger drive car;
        }
        else {
            respond {
                You get in your car, start the ignition, 
                and drive to the opposite side of the parking lot. 
                In retrospect, you probably could have walked that 
                distance, but it's cold outside, ok? You walk up 
                to Emily's front door.
            }
            move-to emily-house;
            trigger look;
        }
    }
    command take doorbell {
        respond {
            You try to pull it off the wall, but it won't come loose.
        }
    }
    command ring doorbell {
        respond {
            Ding ding! You get really excited because you think
            you have a package. Then you remember that it's just you
            being an idiot and ringing your own doorbell.
        }
    }
    command knock {
        respond {
            You knock on your own door. No one responds because
            it's your own door and you live alone.
        }
    }
    object doorbell {
        A little button that makes that sound that signifies
        that you have a package.
    }
}

location emily-house outside {
    synonym "plant" "potted plant" "dead plant";
    synonym "knock" "knock on door" "knock at door" "knock door" 
    "ring doorbell" "call for emily" "yell" "call" "knock on emilys door";
    synonym "open door" "enter" "enter house" "enter door";
    synonym "deliver" "leave" "give emily" "give" "drop" "add";
    synonym "drive" "go" "drive to";
    synonym "package" "package emily" "package to emily" "package on pile"
    "package to pile" "package at door" "package door";
    synonym "home" "house" "your home" "your house";
    synonym "post office" "post-office" "postoffice";
    synonym "packages" "pile of packages" "boxes" "pile of boxes" "pile"
    "pile packages" "pile boxes";
    synonym "door" "doorstep";
    synonym "open window" "smash window" "enter through window";
    synonym "throw package" "throw package at door";

    command look {
        respond {
            A small apartment with a door but no windows 
            facing you. A wilting, frozen, potted plant sits
            on the porch. Beside the plant, a wilting, frozen, pile of
            packages also sits on the proch. You wonder if Emily has
            ever bothered to claim her packages.
        }
    }
    command open window {
        respond {
            You can't find a window.
        }
    }
    command throw package {
        if `hasEmilyPackage` {
            respond {
                You throw the package as hard as you can at Emily's door.
                It lands with a thud. you hope there wasn't anything
                fragile in there. Oh well. Good enough. Time to go
                home a tell Emily on chat.
            }
            set returnedEmilyPackage 1;
            set hasEmilyPackage 0;
            if `eq hintsState "deliver2"` {
                set hintsState "chat";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                You don't have a package for Emily. 
                Your stuff belongs to you, not Emily. 
            }
        }
    }
    command console plant {
        respond {
            That plant looks so sad that it can't
            even be cheered by your kind words.
        }
    }
    command open plant {
        respond {
            You open the plant. Inside, you find a note that says
            "congratulations! You opened a plant!" You put the note 
            back and close the plant.
        }
    }
    command close plant {
        respond {
            The plant is already closed.
        }
    }
    command take plant {
        respond {
            Something feels wrong about taking the plant off
            Emily's porch.
        }
    }
    command knock {
        respond {
            You get no response. Through the thin 
            door, you think you can hear someone typing 
            furiously on a keyboard, but you can't be 
            entirely sure.
        }
    }
    command open door {
        respond {
            You probably shouldn't break into Emily's house.
            Breaking into other people's houses seems rude.
        }
    }
    command give package emily {
        trigger deliver package;
    }
    command drive emily {
        respond {
            You're already at Emily's house. Even you aren't
            planning to waste gas to get to someplace you already are.
        }
    }
    command drive somewhere {
        if `hasEmilyPackage` {
            respond {
                Just leave Emily's package here first. She'll
                never pick it up if you don't.
            }
        }
        else {
            respond {
                You drive around in circles for fifteen minutes,
                then somehow end up back at Emily's house. You
                get out of the car.
            }
        }
    }
    command deliver package {
        if `hasEmilyPackage` {
            respond {
                You set the package on Emily's doorstep 
                and ring the doorbell. You wait around a while, 
                but no one answers. Oh well, maybe you can tell her
                on chat.
            }
            set returnedEmilyPackage 1;
            set hasEmilyPackage 0;
            if `eq hintsState "deliver2"` {
                set hintsState "chat";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                You don't have a package for Emily. 
                Your stuff belongs to you, not Emily. 
            }
        }
    }
    command drive home {
        if `hasEmilyPackage` {
            respond {
                Just leave Emily's package here first. She'll
                never pick it up if you don't.
            }
        }
        else {
            respond {
                You walk back to your car, drive across the parking
                lot, and arrive at your door step.
            }
            move-to entryway;
            trigger look;
        }
    }
    command drive post office {
        if `and hasSeenAddress (not donePostOffice)` {
            respond {
                Good idea. You should return that package like an
                outstanding citizen.
            }
            # use response from house driving to post office
            move-to outdoors;
            trigger drive post office;
        }
        else {
            respond {
                Why would you go to the post office?
            }
        }
    }
    command take packages {
        respond {
            This large pile of packages is really testing your
            restraint. But Emily is your good friend from the chat
            room and you don't want to ruin your friendship.
        }
    }
    object plant {
        It's pretty dead. You're not sure the owner has ever 
        watered it, but the coating of ice probably means that
        doesn't matter anymore.
    }
    object pot {
        Blue, with a dead plant.
    }
    object door {
        A slab of wood that separates Emily's house from the cold,
        cold outside. It's surprisingly effective.
    }
    object packages {
        A large pile of packages that must have been left
        by previous visitors. You could leave another package right on
        top.
    }
}

location postoffice global {
    synonym "man" "employee" "worker" "kleisthenes" "person" "guy" "clerk";
    synonym "scream" "yell";
    synonym "flail" "wave your arms" "wave arms" "wave";
    synonym "punch" "hit" "slap" "hurt" "harm" "kill" "murder" 
    "kick" "stab";
    synonym "burn" "burn the post office down" 
    "burn post office down" "burn post office to ground" "burn down" 
    "burn post office" "start fire" "light fire";
    synonym "buy" "purchase" "take";
    synonym "peanuts" "packaging peanuts" "packing peanuts";
    synonym "boxes" "packing boxes" "packaging boxes";
    synonym "chocolate" "packing chocolate bar" "packaging chocolate bar"
     "chocolate bar" 
    "chocolate bars" "packaging chocolate" "packing chocolate";
    synonym "steal" "eat";
    synonym "cards" "card";
    synonym "drive" "drive to" "go";
    synonym "eye" "creepy eye" "yellow eye" "yellow creepy eye";
    synonym "solitaire" "game" "solitaire game";
    synonym "home" "back";
    synonym "address" "address on package" "package address"
     "mr robertson" "mr robertsons house"
    "robertsons house" "robertson" "13310 podwoic avenue";
    synonym "tape" "packing tape" "packaging tape";
    synonym "talk man" "ask man about package" "address man";
    synonym "show package" "show medallion to man" "show medallion"
    "show package to man" "show man package" "show man medallion";
    synonym "give package man" "give man package" "give package to man";
    synonym "punch man with pen" "punch with pen";
    synonym "ruin" "wreck";
    synonym "check pulse" "check man for pulse" 
    "check for pulse" "check man pulse";
    synonym "drive address" "deliver package";
    synonym "ruin" "mess up";
    
    command look {
        respond {
            The bell at the top of the door signals your arrival. 
            Across the room, a man is sitting behind the counter,
            focused intently on something in front of him. 
            He doesn't even look up. Did he even notice the bell?

            Besides the counter and inattentive employee, the 
            room contains some shelves of packing and shipping
            necessities.
        }
    }
    command leave {
        if `donePostOffice` {
            respond {
                You just want to wander aimlessly out the door? Give
                yourself some more direction. You need it.
            }
        }
        else {
            respond {
                You're going to get this man's attention even if it
                involves burning down the post office.
            }
        }
    }
    command ruin solitaire {
        respond {
            You mess up the order of the cards by shoving your
            hand across the desk. The man patiently gathers up all 
            of the cards and places them in the exact order
            they were in before, then continues.
        }
    }
    command buy solitaire {
        respond {
            You really want nothing to do with that game.
        }
    }
    command check pulse {
        respond {
            You put your fingers on his wrist and listen for a pulse.
            You're pretty sure you feel a heart beat.
        }
    }
    command show package {
        respond {
            You hold up the empty package and the medallion,
            and try using words to explain your situation.
            Words are ineffective. You could wave your arms, punch
            the man, yell, burn the place down. No effect.
        }
    }
    command throw pen at man {
        respond {
            You toss your pen at the man. It falls sadly to the ground a
            few feet away. You pick it back up.
        }
    }
    command punch man with pen {
        respond {
            You take out your pen and jab it into the man's
            hand. He does not respond.
        }
    }
    command say hello {
        trigger talk man;
    }
    command demand attention {
        respond {
            You use your favorite toddler strategies, but to no avail.
        }
    }
    command give package man {
        respond {
            You shove your package under the man's face and
            make grunting noises to indicate that he should take it.
            He pays the pacakge just enough consideration to shove it aside
            to get back to his solitaire game. You take back your package.
        }
    }
    command talk man {
        respond {
            You start talking. You continue talking. You take
            a convenitent break from talking, during which
            time the man might interject some words into
            your polite, but one-sided conversation. 

            Nope, not going to happen. That game of solitaire
            must be rather interesting. You could scream, 
            hit him, flail, burn the post office to the ground,
            and he wouldn't notice. In fact, you inform him
            of this observation. He doesn't respond.
        }
    }
    command win solitaire {
        respond {
            That game is pretty hopeless.
        }
    }
    command go counter {
        respond {
            You walk up to the counter.
        }
        trigger talk man;
    }
    command talk {
        trigger talk man;
    }
    command look man {
        respond {
            There's a plastic name pin on his shirt that reads
            'KLEISTHENES', which you are sure no one has been
            named, ever. Certainly not this guy, anyway. 
            He is really focused on a game of solitaire right 
            now. You can tell just by looking at his face that 
            no matter what you do, he is not going to acknowledge
            your presence in any way. Screaming, waving your arms,
            punching him, burning down the post office - 
            all useless. 
            I-will-ignore-burning-buildings-to-finish-this-game
            is written all over his face. You are good at reading
            faces, you think.
        }
    }
    command talk counter {
        trigger talk man;
    }
    command scream {
        respond {
            You let out a primal scream. 
            The clerk doesn't react, which makes you
            feel a little sad about the lack of power
            you seem to have to affect change in your own life.
            On the bright side, at least your face reading prowess
            has been partially confirmed.
        }
        set attentionAttempts `add attentionAttempts 1`;
        if `gt attentionAttempts 3` {
            respond {
                Ok. A game of cards is more interesting than you. Ok,
                that's fine, you can deal with that. You just wanted
                to do a good thing. You just wanted to return the
                creepy medallion. 

                This clearly isn't going to happen unless you take
                matters into your own hands. But you can do this. 
                You are going to set your life in order. You are going
                to stop waiting for something to change. The thing
                that needs to change is you. You feel so much resolve,
                so much personal agency right now.

                You will drive to the address on the package and
                personally deliver it to its rightful owner.
            }
            set donePostOffice 1;
            if `eq hintsState "attention"` {
                set hintsState "deliver1";
                set hintsCounter 0;
            }
        }
    }
    command flail {
        respond {
            You flail wildly. Nothing happens.
        }
        set attentionAttempts `add attentionAttempts 1`;
        if `gt attentionAttempts 3` {
            respond {
                Ok. A game of cards is more interesting than you. Ok,
                that's fine, you can deal with that. You just wanted
                to do a good thing. You just wanted to return the
                creepy medallion. 

                This clearly isn't going to happen unless you take
                matters into your own hands. But you can do this. 
                You are going to set your life in order. You are going
                to stop waiting for something to change. The thing
                that needs to change is you. You feel so much resolve,
                so much personal agency right now.

                You will drive to the address on the package and
                personally deliver it to its rightful owner.
            }
            set donePostOffice 1;
            if `eq hintsState "attention"` {
                set hintsState "deliver1";
                set hintsCounter 0;
            }
        }
    }
    command punch man {
        respond {
            You can't bring yourself to do violence
            to a random stranger, as awful as he may be.
        }
        set attentionAttempts `add attentionAttempts 1`;
        if `gt attentionAttempts 3` {
            respond {
                Ok. A game of cards is more interesting than you. Ok,
                that's fine, you can deal with that. You just wanted
                to do a good thing. You just wanted to return the
                creepy medallion. 

                This clearly isn't going to happen unless you take
                matters into your own hands. But you can do this. 
                You are going to set your life in order. You are going
                to stop waiting for something to change. The thing
                that needs to change is you. You feel so much resolve,
                so much personal agency right now.

                You will drive to the address on the package and
                personally deliver it to its rightful owner.
            }
            set donePostOffice 1;
            if `eq hintsState "attention"` {
                set hintsState "deliver1";
                set hintsCounter 0;
            }
        }
    }
    command burn {
        respond {
            This seems really inadvisable. You should at 
            least wait until you receive your real package.
        }
        set attentionAttempts `add attentionAttempts 1`;
        if `gt attentionAttempts 3` {
            respond {
                Ok. A game of cards is more interesting than you. Ok,
                that's fine, you can deal with that. You just wanted
                to do a good thing. You just wanted to return the
                creepy medallion. 

                This clearly isn't going to happen unless you take
                matters into your own hands. But you can do this. 
                You are going to set your life in order. You are going
                to stop waiting for something to change. The thing
                that needs to change is you. You feel so much resolve,
                so much personal agency right now.

                You will drive to the address on the package and
                personally deliver it to its rightful owner.
            }
            set donePostOffice 1;
            if `eq hintsState "attention"` {
                set hintsState "deliver1";
                set hintsCounter 0;
            }
        }
    }
    command keep package {
        respond {
            You are a moral citizen. You will return this package
            even if it kills you. It might kill you.
        }
    }
    command buy tape {
        respond {
            You don't need that. You bought a value pack of 250
            rolls from Swifts three years ago. It was quite a deal!
        }
    }
    command buy peanuts {
        respond {
            You still have the packaging peanuts scattered across
            your floor from the last package. The one you're trying
            to return to its rightful owner, remember? You don't need
            these.
        }
    }
    command buy boxes {
        respond {
            Those would make an excellent fort. But Swifts is
            pretty good about giving you boxes with your purchases.
            You probably have at least a hundred somewhere in your
            apartment, not counting the ones you've mutilated. You
            don't need more boxes.
        }
    }
    command buy chocolate {
        respond {
            You pick up a packing chocolate. 
            This is so necessary. You walk over and set it on
            the counter, but the clerk ignores you. You are 
            devastated. This is probably the worst thing that 
            will happen to you today.
        }
    }
    command steal chocolate {
        respond {
            It's tempting. But you have more self restraint than
            that. A tiny, tiny bit more. You hold up your thumb 
            and forefinger, a centimeter apart, to demonstrate this
            tiny bit.
        }
    }
    command steal peanuts {
        respond {
            They're actually not tasty, so why would you? 
            You've tried them before.
        }
    }
    command play solitaire {
        respond {
            You offer to join the game of solitaire. The man makes no
            response. It's like he'd prefer to play solitaire alone.
        }
    }
    command drive home {
        if `donePostOffice` {
            respond {
                YOU FEEL SO MUCH RESOLVE, SO MUCH PERSONAL AGENCY 
                RIGHT NOW.

                YOU WILL DRIVE TO THE ADDRESS ON THE PACKAGE AND
                PERSONALLY DELIVER IT TO ITS RIGHTFUL OWNER.
            }
        }
        else {
            respond {
                You still need to return that package! You
                aren't done here!
            }
        }
    }
    command drive somewhere {
        if `donePostOffice` {
            respond {
                Maybe you should drive to Mr. Robertson's
                house instead of aimlessly driving around.
            }
        }
        else {
            respond {
                You aren't ready to give up on this employee,
                even if he won't pay any attention to you. You will scream.
                You will wave your arms. You will kick him. You will start
                a fire. You will get his attention!
            }
        }
    }
    command drive address {
        respond {
            Fine. This man isn't going to listen to you.
            You're delivering the package your way.

            You begin to drive. 

            It's understandable how the package could have
            been delivered to the wrong address, given the 
            awful city planning that went on during Rockburg 
            early years. Matthias Matusiak, Rockburg's founder,
            did many great things, but creating an avenue with two
            of every street number, only differentiable 
            by use of 'E' or 'W', was somewhat asinine. You 
            would also have preferred the avenue not have
            a difficult to pronounce Polish name. 

            You always forget how small Rockburg is. 
            Actually, you have no idea what size Rockburg is.
            The point is, you are at the address, and it didn't
            seem to take that long to get there. You get 
            out of the car and walk to the doorstep of the 
            intended package recipient's home.
        }
        move-to robertson-front-door;
        if `eq hintsState "deliver1"` {
            set hintsState "findCat";
            set hintsCounter 0;
        }
    }
    command buy name pin {
        respond {
            You really have no need of a name pin that say 'KLEISTHENES'.
        }
    }
    object counter {
        The counter's sole purpose is to hold the cards
        that the unresponsive man is using to play solitaire.
    }
    object shelves {
        Packing tape, packing peanuts, packing boxes.
        There are also some packing chocolate bars near
        the front counter. On closer inspection, these are
        just chocolate bars. 
    }
    object tape {
        Sticky on one side but not on the other. You often confuse
        the two sides.
    }
    object peanuts {
        These ones are the environmentally friendly kind that dissolve
        in water. Slightly less of a choking hazard.
    }
    object boxes {
        Boxes that do not have things inside of them. Way less interesting
        than boxes that do have things inside of them.
    }
    object chocolate {
        Yummmmmmmmmm
    }
    object bell {
        Bells should be heard but not seen. That's your motto for bells.
    }
    object solitaire {
        The man has managed to find all of the clubs up to nine,
        but the hearts stack doesn't even have an ace. That might be
        problematic.
    }
    object clubs {
        The stack goes all the way up to nine!
    }
    object hearts {
        All the hearts cards are clogging up the game. You think
        it might prevent the man from winning.
    }
    object spades {
        There's the queen of spades! You were always a little
        scared of her.
    }
    object diamonds {
        Diamond cards should be more shiny and sparkly.
    }
    object cards {
        A normal deck of cards. The picture on the back seems to
        be of a creepy yellow eye.
    }
    object eye {
        Oddly familiar.
    }
    object name pin {
        It says 'KLEISTHENES' and is about as responsive
        as the man wearing it.
    }
}

location robertson-front-door outside {
    synonym "bush" "bushes";
    synonym "remove" "take off";
    synonym "open door" "enter" "enter house" "enter door";
    synonym "leave package" "leave medallion" "leave package at door"
     "leave medallion at door" "leave package at house"
      "leave medallion at house" "deliver package";
    synonym "follow cat" "drive after cat" "follow footprints" 
    "enter bushes" "drive bushes" 
    "drive with cat" "drive through bushes" "leave through bushes";
    synonym "drive" "drive to" "go";
    synonym "emily" "emilys" "emilys house" 
    "emily house" "emilys place";
    synonym "post office" "post-office" "postoffice";
    synonym "snow" "ground";
    synonym "bushes" "bush" "plant" "plants";
    synonym "footprints" "footprint" "pawprint" "pawprints";
    synonym "trees" "tree";
    synonym "knock" "knock on door" "knock at door";
    synonym "home" "house";
    synonym "headbutt" "head butt" "hit head against";
    synonym "door" "door step";
    synonym "ring doorbell" "push doorbell" "ring bell" "push bell";
    synonym "yard" "backyard" "sideyard" "back yard" "side yard";
    synonym "walk around home" "drive back door";
    synonym "drive car" "take in car";
    synonym "headbutt" "bang head on";
    
    command look {
        respond {
            Wow, a doorstep. There's a door in front of you.

            Oh, you wanted to look at the house? It's a cozy-sized 
            house with a small yard coated in snow, a porch and a 
            couple of surrounding trees. It also has a doorstep. 
            With a door. Did I mention that already? You find the 
            home rather appealing.
        }
    }
    command open window {
        respond {
            You can't find a window to open.
        }
    }
    command drive {
        trigger drive car;
    }
    command leave {
        trigger drive car;
    }
    command drive car{
        if `hasMedallion` {
            respond {
                You came all this way to deliver the package,
                and you will deliver it regardless of what
                forces of nature or not nature try to bring you down.
            }
        }
        else {
            respond {
                You get in the car and sit around for a while
                before you realize you have no idea where 
                you were planning to go
            }
        }
    }
    command drive somewhere {
        if `hasMedallion` {
            respond {
                You came all this way to deliver the package,
                and you will deliver it regardless of what
                forces of nature or not nature try to bring you down.
            }
        }
        else {
            respond {
                Just go to Emily's house and deliver her package
                before you drive around in circles.
            }
        }
    }
    command slip medallion under door {
        respond {
            The medallion is just a little too wide to
            fit under the door.
        }
    }
    command drive yard {
        trigger look yard;
    }
    command walk around home {
        respond {
            You can't see another side to the house. Maybe climbing
            that tree over there will help?
        }
    }
    command kick door {
        respond {
            You pound your feet against the door because
            you once heard that this strategy was more effective
            than knocking. Whoever told you that was wrong.
        }
    }
    command headbutt door {
        respond {
            Ouch. Not effective.
        }
    }
    command ring doorbell {
        respond {
            Ding ding ding! "You've got mail!" you shout.
            No response. Some people just aren't eager enough about
            their packages.
        }
    }
    # :( drive cinnamoned from go
    command drive porch {
        respond {
            You walk onto the porch and jump up and
            down a couple of times to see how well
            it supports your weight. It works quite 
            well, you determine, which is lucky because you
            didn't have a plan if you broke the porch. Then
            you feel awkward, so you walk back toward you car.
        }
    }
    command drive home {
        if `hasMedallion` {
            respond {
                You came all this way to deliver the package,
                and you will deliver it regardless of what
                forces of nature or not nature try to bring you down.
            }
        }
        else {
            respond {
                You should probably deliver Emily's
                package before you get all comfy and cozy in
                your nice warm home. You'd probably never want
                to leave again.
            }
        }
    }
    command drive post office {
        respond {
            No! Not there! You don't ever want to go back to there!
        }
    }
    command drive emily {
        if `hasMedallion` {
            respond {
                That medallion belongs to that Robertson guy, not
                Emily. You're staying here until it's delivered.
            }
        }
        else {
            respond {
                You get in your car, start the engine,
                and drive to Emily's house. The whole way there,
                her package sits on the passenger seat, taunting you.
                Oh, how you want to open that package. But you have self
                restraint. You really do.
            }
            move-to emily-house;
        }
    }
    command look snow {
        if `not catPresent` {
            respond {
                Cold and icy. You wrap your scarf tighter 
                around yourself.
            }
        }
        else {
            respond {
                Footprints of cat paws lead toward the bushes.
            }
        }
    }
    command look bushes {
        if `not catPresent` {
            respond {
                A couple of leafy bushes, where the leaves are gone
                and replace with ice.
            }
        }
        else {
            respond {
                The cat went that way. You felt a connection 
                with that cat. Maybe you should follow her.
            }
        }
    }
    command step on door {
        respond {
            The vertical orientation of the door makes
            that somewhat difficult.
        }
    }
    command look footprints {
        if `not catPresent` {
            respond {
                The only footprints here are your own.
            }
        }
        else {
            respond {
                Cat footprints in the snow, showing 
                you a convenient path.
            }
        }
    }
    command look cat {
        if `not catPresent` {
            respond {
                You don't see any cats around here, though
                admittedly you didn't look very hard.
            }
        }
        else {
            respond {
                The cat left through the bushes, giving you a look
                that demanded that it must be followed.
            }
        }
    }
    command use medallion on cat {
        if `not catPresent` {
            respond {
                You don't see any cats around here, though
                admittedly you didn't look very hard.
            }
        }
        else {
            if `hasMedallion` {
                respond {
                    The cat left through the bushes, giving you a look
                    that demanded that it must be followed.
                }
            }
            else {
                respond {
                    You left the medallion and the cat in the house,
                    remember?
                }
            }
        }
    }
    command look trees {
        if `not catPresent` {
            respond {
                Two tall birch trees hang over the house, 
                each with a soft dusting of snow. A hole 
                of blackness swirls in the leaves. It's 
                coming closer. The tree leaves part from 
                its path. The blackness! It approaches! 
                It will consume your soul! It leaps toward you!
                It's will destroy you entirely!
                
                Oh wait, it's just a black cat. Nevermind.
                
                The cat has familiar looking yellow eyes. 
                She stares shrewdly at you, her tail raised. If 
                your facial-reading abilities apply to cats, 
                you would interpret that expression as saying
                come-with-me-mortal. She turns and leaves through
                the bushes.
            }
            set catPresent 1;
            if `eq hintsState "findCat"` {
                set hintsState "followCat";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                Two tall birch trees. Beneath them,
                cat footprints in the snow, showing 
                you a convenient path.
            }
        }
    }
    command drive trees {
        trigger climb trees;
    }
    command climb trees {
        if `not catPresent` {
            respond {
                You try to climb the tallest tree.
                You get about half way up when the tree
                hisses at you.

                Wait. Trees don't hiss.

                A black cat jumps onto your face, and you both
                fall to the ground. Luckily the snow cushions
                your plummet.

                The cat has familiar looking yellow eyes. 
                She stares shrewdly at you, her tail raised. If 
                your facial-reading abilities apply to cats, 
                you would interpret that expression as saying
                come-with-me-mortal. She turns and leaves through
                the bushes.

            }
            set catPresent 1;
            if `eq hintsState "findCat"` {
                set hintsState "followCat";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                You climb the tree. You find nothing of interest.
                You try to climb down. Well, you reach the ground,
                so let's just say you managed to climb down.
            }
        }
    }
    command knock {
        respond {
            You knock three times on the door, 
            and wait for an answer. No one responds. Oh well.
        }
    }
    command open door {
        respond {
            The door is locked. You pull the door handle harder. 
            It's still locked. Darn. You thought that would work.
        }
    }
    command remove scarf {
        respond {
            No. Absolutely not.
        }
    }
    command leave package {
        if `hasMedallion` {
            respond {
                You kind of tore the package to tiny pieces,
                and feel a little bit bad about that. You should 
                probably hand deliver the medallion so you can explain.
            }
        }
        else {
            respond {
                That package is gone! You are free of it!
            }
        }
    }
    command talk cat {
        if `not catPresent` {
            respond {
                What cat? Meow, meow, meow! No cat responds.
            }
        }
        else {
            if `hasMedallion` {
                respond {
                    Meow! You shout in your best kitty voice.
                    The cat is gone. Maybe you should follow her.
                }
            }
            else {
                respond {
                    Meow!
                }
            }
        }
    }
    command eat cat {
        if `not catPresent` {
            respond {
                What cat? But even if you found a cat,
                you're not sure you'd wat to eat her.
            }
        }
        else {
            respond {
                Kitties aren't for eating!
            }
        }
    }
    command follow cat {
        if `not catPresent` {
            respond {
                What cat? You love following adorable kitties
                around, but you don't see one.
            }
        }
        else {
            if `hasMedallion` {
                respond {
                    You follow the black cat into the bushes. 
                    After pushing through some leaves, you find yourself
                    in a sequestered backyard of the house. The cat 
                    is nowhere to be seen.
                }
                move-to backyard;
                trigger look;
                if `eq hintsState "followCat"` {
                    set hintsState "enterHouse";
                    set hintsCounter 0;
                }
            }
            else {
                respond {
                    You already followed that cat. Nothing good came
                    of it. Well, you did meet Stuart. And he was kinda
                    dreamy. Maybe you should follow the cat back! No wait,
                    that would lead you right back into the house, and
                    this time breaking in would be so awkward. You resist
                    the temptation.
                }
            }
        }
    }
    object door handle {
        Shiny and brass. Good for opening unlocked doors. 
        Less effective against locked doors.
    }
    object scarf {
        Your fuzzy, fuzzy, scarf.
    }
    object home {
        Quaint and cozy. A couple of trees shade it from the sun.
    }
    object sun {
        You look at the sun. It's bright. Your eyes hurt.
        You stop looking at the sun.
    }
    object porch {
        A nice porch in the front of the house.
    }
    object yard {
        From here, you can see no other yard.
    }
    object window {
        There isn't a window. You see no way in.
    }
    object doorstep {
        A step that leads you to the door.
    }
    object door {
        It blocks the way into this person's house.
    }
    object car {
        You lovely car. It's gotten you this far.
    }
}

location backyard outside {
    synonym "reindeer" "Christmas reindeer";
    synonym "take" "pet" "touch" "ride";
    synonym "go back" "return" "go through bushes" "go bushes";
    synonym "bushes" "bush" "plant" "plants";
    synonym "open window" "break into house" "enter house"
    "go house" "go into house" "enter window"
    "go window" "go through window"
    "climb through window" "climb window";

    command look {
        respond {
            A circle of those light-up Christmas reindeer
            stand facing outward. It's an odd setup considering
            you are in a secluded backyard surrounded on all sides
            by fences. Some people just don't like to ostentatiously
            flout their decorations in their neighbors' faces. Weird.
            The back side of the house has no doors, but one of the
            windows appear to be cracked open a bit.
        }
    }
    command take reindeer {
        respond {
            You reach your hand out toward the fake deer. 
            The moment your fingers brush the cold, metallic 
            decoration, the deer and its companions spring to life.
            You jump back and watch in a stupefying combination
            of horror and fascination as the previously inanimate
            creatures engage in a ferocious battle to the death.
            
            One after another, each Christmas decorations fights
            until it or its opponent has been reduced to a pile
            of twisted wires and flickering lights. At last,
            only remaining deer claims victory as it prances
            upon the corpses of its brethren. It paws at the
            twisted wires for a moment before trotting back to
            its position in the now vacant ring of deer. As
            if summoned, the wires untangle themselves and
            reassemble into the remaining herd. The deer resume
            their positions and the entire scene appears completely
            unchanged. Even the freshly fallen snow bears no markings
            of a scuffle ever occurring. Your sense of stupefaction
            lifts, leaving you only with a greater appreciation
            for inanimate Christmas decorations.
        }
    }
    command go back {
        respond {
            You have a strange desire to follow that cat,
            wherever it went.
        }
    }
    command use medallion with reindeer {
        respond {
            You hold out the strange medallion to the reindeer. 
            The one that you, for some unknown reason, identify
            as the leader tilts its head toward you as the 
            Christmas lights in its eyes flash red.
            That was some pretty good animatronics,
            you must admit. You pocket the medallion.
        }
    }
    command open window {
        respond {
            You push open the window until you are able to 
            fit through the gap. So you fit yourself through
            the gap. Why else would the window be partly open
            if not so you can squeeze your body through?
        }
        move-to room-one;
        trigger look;
        if `eq hintsState "enterHouse"` {
            set hintsState "burn";
            set hintsCounter 0;
        }
    }
    command use medallion on cat {
        respond {
            The cat is nowhere to be found.
        }
    }
    command kick reindeer {
        respond {
            You aim your best kick at the first reindeer. Instead of
            falling over, it gives you a terrifying glower. You back
            away quickly.
        }
    }
    command burn reindeer {
        respond {
            These reindeer don't look very flammable. Besides,
            they might kill you first if you try anything too drastic.
        }
    }
    command talk cat {
        respond {
            Meow! you say. The cat makes no response. You
            can't find her.
        }
    }
    command eat cat {
        respond {
            You can't find the cat, which is probably
            a good thing because you shouldn't eat cats.
        }
    }
    command follow cat {
        respond {
            The cat is nowhere to be found. How did she get away?
        }
    }
    command find cat {
        respond {
            She might have gone inside the house somehow, but you
            can't find her.
        }
    }
    object window {
        Ice coats the glass, making it difficult to see
        inside, but its cracked open just slightly
    }
    object bushes {
        A thick hedge of bushes. From this side, it looks rather 
        difficult to climb through. I guess you were desperate.
        Cats do that to you sometimes.
    }
    object snow {
        Only your own footprints appear in powdery ice. 
        You wonder what happened to the cat.
    }
    object reindeer {
        They look deep into your soul as the Christmas
        lights that define their bodies twinkle ominously.
    }
    object fences {
        Tall fences that prevent you from seeing anywhere else.
    }
    object cat {
        You can't see the cat anymore.
    }
}

environment puzzle-room global{
    synonym "rock" "rock collection" "rocks" "collection" "flint";
    synonym "bookshelf" "books";
    synonym "pet" "touch" "poke" "hug" "scratch";
    synonym "pet cat" "scratch cats ears";
    synonym "read passion in paradise" "read passion in pot" 
    "read passion in poppy field" "read passion in pompeii";
    synonym "vonnegut" "vonnegut novel" "vonnegut bookshelf"
    "kurt vonnegut novel"
    "vonnegut novels" "kurt vonnegut novels" "kurt vonnegut";
    synonym "book in another language" "books in another language" "a book in another language" "the book in another language";
    synonym "fantasy series" "fantasy book" "fantasy books";
    synonym "leave medallion" "leave package" "drop medallion" "drop package";
    synonym "cabinet" "filing cabinet" "drawers";
    synonym "open" "look through";
    synonym "food" "cat food";
    synonym "feed cat" "use food with cat" 
    "use cat food with cat" "give food to cat" 
    "give cat food to cat" "give cat food cat" 
    "give food cat" "give cat food" "give cat cat food"
    "feed food to cat" "feed food" "offer food to cat" "offer food" 
    "give food" "use food with cat" "use food";
    synonym "alarm" "fire alarm";
    synonym "painting" "picture" "image";
    synonym "leave" "walk out" "go door" "leave room"
    "go through door" "leave door" "leave through door" "exit"
    "go hallway";
    synonym "go outside" "jump out window" "go out window" "go window"
    "open window" "jump through window";
    synonym "scorch" "scorch marks" "scorch mark"
     "mark" "scorches" "marks";
    synonym "1" "in 1" "in drawer 1" "drawer 1" "first drawer" 
    "say 1";
    synonym "2" "in 2" "in drawer 2" "drawer 2" "second drawer"
    "say 2";
    synonym "3" "in 3" "in drawer 3" "drawer 3" "third drawer"
    "say 3";
    synonym "4" "say 4";
    synonym "5" "say 5";
    synonym "6" "say 6";
    synonym "" "of cabinet";
    synonym "couch" "sofa";
    synonym "sit" "sit on" "relax" "relax on" "sit in" "sit down";
    synonym "sleep" "sleep on couch" "sleep couch" "nap on couch" 
    "nap couch" "nap";
    synonym "chair" "armchair";
    synonym "decor" "decoration";
    synonym "stay" "stay here";
    synonym "marshmallows" "roast marshmallows" "cook marshmallows"
    "bring marshmallows";
    synonym "hot dogs" "roast hot dogs" "cook hot dogs"
    "bring hot dogs";
    synonym "hot dogs" "hot dog" "hotdog" "hotdogs";
    synonym "door" "doorway";
    synonym "apologize" "apologize to";
    synonym "talk cat" "meow at cat" "meow at" "meow" "meow cat";
    synonym "hiss cat" "hiss at cat";
    synonym "befriend" "make friends with";
    synonym "give cat medallion" "put medallion on cat"
    "use medallion with cat";
    synonym "open cabinet" "look in cabinet";
    synonym "throw food" "throw food at cat";
    
    command feed cat {
        if `hasCatFood` {
            respond {
                You take the handful of cat food and offer it
                to that kind of creepy black cat. The cat wanders
                over to you, looking kind of adorable despite her
                bright yellow eyes that stare deep into the depths
                of your soul. She happily eats up the food and
                wanders off. Then the room catches fire.

                You ponder your options for a moment, thinking you
                probably should leave before you die, when,
                to make matters even worse, the fire alarm goes off.
                Why do people even have fire alarms? You know there's 
                a fire. That's why your skin is burning off.
                Oh yeah, you should probably leave the room.
            }
            set hasCatFood 0;
            set roomOnFire 1;
            if `eq hintsState "feed"` {
                set hintsState "fire";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                The cat looks curious, but then realizes you have no
                food and glares angrily.
            }
        }
    }
    command throw food {
        if `hasCatFood` {
            respond {
                You toss the cat food toward the cat. She looks at
                little suspicious, but soon wanders in, sniffs the food,
                and happily eats it up. She wanders off.

                Suddenly the room catches fire.


                You ponder your options for a moment, thinking you
                probably should leave before you die, when,
                to make matters even worse, the fire alarm goes off.
                Why do people even have fire alarms? You know there's 
                a fire. That's why your skin is burning off.
                Oh yeah, you should probably leave the room.
            }
            set hasCatFood 0;
            set roomOnFire 1;
            if `eq hintsState "feed"` {
                set hintsState "fire";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                You have nothing to throw at the cat.
            }
        }
    }
    command eat cat {
        respond {
            The cat does not look particularly delicious.
        }
    }
    command cut painting out of frame {
        respond {
            You wouldn't destroy this...beautiful...art.
        }
    }
    command burn room {
        if `roomOnFire` {
            respond {
                No need. The room is already on fire.
            }
        }
        else {
            respond {
                That seems a little unneccessary. This
                isn't even your house.
            }
        }
    }
    command burn painting {
        if `roomOnFire` {
            respond {
                No need. The room is already on fire.
            }
        }
        else {
            respond {
                You wouldn't destroy true art!
            }
        }
    }
    command put medallion on painting {
        if `hasMedallion` {
            respond {
                You drape the medallion over the corner
                of the painting. The image turns into
                a picture of undescribable terror, which
                may or may not have included a black cat.
                You remove the medallion.
            }
        }
        else {
            respond {
                You don't have a medallion with which to
                try this experiment.
            }
        }
    }
    command talk cat {
        respond {
            "Meow!" you say. The cat makes no reply.
        }
    }
    command burn filing cabinet {
        if `roomOnFire` {
            respond {
                The room is pretty much already in flames. Let's not
                add more.
            }
        }
        else {
            respond {
                That metal structure does not look particularly
                flammable.
            }
        }
    }
    command burn couch {
        if `roomOnFire` {
            respond {
                The room is pretty much already in flames. Let's not
                add more.
            }
        }
        else {
            respond {
                Where would you sit if you burned the couch?
            }
        }
    }
    command put medallion on couch {
        if `hasMedallion` {
            respond {
                You set your medallion on the couch. The couch
                grows four hairy legs and struts around the room.
                This lasts for a couple of minutes before it knocks
                the medallion off its cushions, wobbles back to its
                appropriate place, loses its legs, and collapses.
            }
        }
        else {
            respond {
                You no longer have a medallion with which
                to conduct this experiment.
            }
        }
    }
    command befriend cat {
        respond {
            The cat doesn't seem to have any interest in becoming your
            friend.
        }
    }
    command give cat medallion {
        respond {
            You drape the medallion over the cat's neck. Her yellow
            eyes start glowing. You quickly remove the medallion.
        }
    }
    command hiss cat {
        respond {
            You hiss at the black cat. She makes a simillar reply.
        }
    }
    command find flint {
        respond {
            There might be some in that odd rock collection.
        }
    }
    command stab cat {
        respond {
            You jab your pen into the cat. She yelps
            loudly and stops trusting you.
        }
    }
    command apologize cat {
        respond {
            You give the cat your sincerest apology for all of
            the terrible things you've done. SHe merely flicks her
            tail at you.
        }
    }
    command adopt cat {
        respond {
            That cat does not look like she wants to belong
            to you.
        }
    }
    command take bookshelf {
        respond {
            Which book do you want?
        }
    }
    command burn cat {
        respond {
            Not the kitty!
        }
    }
    command burn bookshelf {
        respond {
            Not all of these beautiful books!
        }
    }
    command burn book {
        if `eq heldBook "Leaves of Grass"` {
            respond {
                You should at least use this paper as kindling
                for some other fire, so that it goes to good use.
            }
        }
        else {
            if `eq heldBook "None"` {
                respond {
                    You don't have a book to burn.
                }
            }
            else {
                respond {
                    No way are you burning `heldBook`!
                }
            }
        }
    }
    command burn everything {
        respond {
            Tempting, but that sounds rude.
        }
    }
    command put book on cabinet {
        if `eq heldBook "None"` {
            respond {
                You don't even have a book to put on the cabinet.
            }
        }
        else {
            respond {
                You place `heldBook` on the filing cabinet. It
                looks really out of place there, so you put it
                back in your pocket.
            }
        }
    }
    command put book on cat {
        if `eq heldBook "None"` {
            respond {
                You don't even have a book to put on the cat.
            }
        }
        else {
            respond {
                You place `heldBook` on the cat. She hisses
                violently, so you take your book back before
                you get any battle scars.
            }
        }
    }
    command put book on couch {
        if `eq heldBook "None"` {
            respond {
                You don't even have a book to put on the sofa.
            }
        }
        else {
            respond {
                You place `heldBook` on the couch. You
                get a strange impulse to burn the couch. You're
                pretty sure this is a bad idea, so you take the 
                book back.
            }
        }
    }
    command put book on bookshelf {
        if `eq heldBook "None"` {
            respond {
                All the books are already on the bookshelf.
            }
        }
        else {
            respond {
                You place `heldBook` back on the bookshelf.
            }
            set heldBook "None";
        }
    }
    command go outside {
        respond {
            You have a vague recollection of coming in through a
            but you don't see a window or anway outside.
        }
        if `roomOnFire` {
            respond {
                You could just go through the door, though, if you're
                concerned about the fire burning around you.
            }
        }
    }
    command stay {
        if `roomOnFire` {
            respond {
                You die in the inferno.

                Just kidding!

                You aren't allowed to be quite this stupid, solitaire
                I'm taking over for now and you are leaving the room.
            }
            trigger leave;
        }
        else {
            respond {
                Good idea! You feel like you have work to do
                in this random stranger's house.
            }
        }
    }
    command marshmallows {
        if `roomOnFire` {
            respond {
                You suspend common sense for a moment to check your
                pockets for marshmallows to roast in the fire. Sadly,
                you find none. You might want to leave.
            }
        }
        else {
            respond {
                You don't have any marshmallows and you're not
                sure why you'd want marshmallows now anyway.
            }
        }
    }
    command hot dogs {
        if `roomOnFire` {
            respond {
                Despite the inferno surrounding you, or maybe because
                of it, you feel rather peckish. Sadly, you forgot to
                pick up some hot dogs before causing a fire. Oh well.
                You might want to leave now.
            }
        }
        else {
            respond {
                You don't have any hot dogs and you aren't
                particularly hungry right now anyway.
            }
        }
    }
    command take painting {
        respond {
            It's pretty firmly attached to the wall.
        }
    }
    command take decor {
        respond {
            All of it? Let's be reasonable here.
        }
    }
    command take package {
        respond {
            You don't see a package you can take. 
            You love packages, though.
        }
    }
    command take cabinet {
        respond {
            You try to stuff an entire filing cabinet
            into your pockets but it just doesn't work.
            You really hate the small pockets on these
            clothes.
        }
    }
    command sleep {
        respond {
            You curl up on the couch a doze off. The cat jumps on top
            of your face, waking you up. You shove her off and stand
            back up.
        }
    }
    command take cat {
        respond {
            The cat does not seem pleased with your attentionAttempts
            to shove her in your pocket. After a valiant struggle,
            you let her go.
        }
    }
    command worship vonnegut {
        respond {
            You've been worshipping Kurt Vonnegut your entire life.
        }
    }
    command take wall {
        respond {
            Your impulsive need to steal everything ends
            right here and now.
        }
    }
    command open bookshelf {
        respond {
            The bookshelf does not open. You can already
            see all the books. There is not secret passageway
            behind it. Good try.
        }
    }
    command burn bookshelf {
        respond {
            Not all those beautiful books!
        }
    }
    command sit {
        trigger sit couch;
    }
    command sit couch {
        respond {
            It's a really comfy couch. You could sit here forever.
            But you aren't going to. It's not even your couch. You have
            better things to do.
        }
    }
    command leave medallion {
        if `hasMedallion` {
            respond {
                You came all this way and you will deliver this
                medallion in person to Mr. Robertson. Besides, you're
                rather fond of the piece and aren't quite sure you
                want to get rid of it just yet.
            }
        }
        else {
            respond {
                You already got rid of that medallion, remember?
            }
        }
    }
    command follow cat {
        respond {
            The cat seems to be staying right here.
        }
    }
    command take rock {
        if `hasFlint` {
            respond { 
                You really only need one piece of flint.
                You learned that at camp.
            }
        }
        else {
            respond {
                You pick up some of the flint from the display
                and pocket it.
            }
            set hasFlint 1;
        }
    }
    command read fantasy series {
        respond {
            Thurglarg begins his adventures as Thurglarina, a maid in
            the village of Urmaston. The first chapter seems to be
            mainly about him reevaluating his gender identity.
            Then a dragon shows up.

            You finish the first chapter and then scrounge up some
            self control to focus on the task at hand, whatever that
            is, and stop reading this. You really struggle with
            self control sometimes.
        }
    }
    command read passion in paradise {
        respond {
            You pull the book off the shelf and begin to become
            emotionally involved in Karen and Santiago's somewhat
            raunchy affair. The writing is just so good. You really
            appreciate good writing.

            After several minutes, the cat hisses at you. 
            What's your deal, cat? You lay the quality
            literature aside.
        }
    }
    command take leaves of grass {
        if `placedBook` {
            respond {
                That book is not on the shelf. You wonder
                if, perhaps, it has been sacrificed to a past or
                future fire.
            }
        }
        else {
            if `eq heldBook "Leaves of Grass"` {
                respond {
                    You're already holding `heldBook`. You caress
                    it gently to remind yourself of this fact.
                }
            }
            else {
                if `not (eq heldBook "None")` {
                    respond {
                        You can really only carry one book at a time,
                        so you lovingly deposit `heldBook` in its
                        proper place on the bookshelf.
                    }
                }
                set heldBook "Leaves of Grass";
                respond {
                    You pick up `heldBook`.
                }
            }
        }
    }
    command take vonnegut {
        if `eq heldBook "a Kurt Vonnegut novel"` {
            respond {
                You're already holding `heldBook`. You caress
                it gently to remind yourself of this fact.
            }
        }
        else {
            
            if `not (eq heldBook "None")` {
                respond {
                    You can really only carry one book at a time,
                    so you lovingly deposit `heldBook` in its
                    proper place on the bookshelf.
                }
            }
            set heldBook "a Kurt Vonnegut novel";
            respond {
                You pick up `heldBook`.
            }
        }
    }
    command take book in another language {
        if `eq heldBook "a book in another language"` {
            respond {
                You're already holding `heldBook`. You caress
                it gently to remind yourself of this fact.
            }
        }
        else {
            
            if `not (eq heldBook "None")` {
                respond {
                    You can really only carry one book at a time,
                    so you lovingly deposit `heldBook` in its
                    proper place on the bookshelf.
                }
            }
            set heldBook "a book in another language";
            respond {
                You pick up `heldBook`.
            }
        }
    }
    command take passion in paradise {
        if `eq heldBook "Passion in Paradise"` {
            respond {
                You're already holding `heldBook`. You caress
                it gently to remind yourself of this fact.
            }
        }
        else {
            
            if `not (eq heldBook "None")` {
                respond {
                    You can really only carry one book at a time,
                    so you lovingly deposit `heldBook` in its
                    proper place on the bookshelf.
                }
            }
            set heldBook "Passion in Paradise";
            respond {
                You pick up `heldBook`.
            }
        }
    }
    command take passion in pompeii {
        if `eq heldBook "Passion in Pompeii"` {
            respond {
                You're already holding `heldBook`. You caress
                it gently to remind yourself of this fact.
            }
        }
        else {
            
            if `not (eq heldBook "None")` {
                respond {
                    You can really only carry one book at a time,
                    so you lovingly deposit `heldBook` in its
                    proper place on the bookshelf.
                }
            }
            set heldBook "Passion in Pompeii";
            respond {
                You pick up `heldBook`.
            }
        }
    }
    command take passion in pot {
        if `eq heldBook "Passion in a Pot"` {
            respond {
                You're already holding `heldBook`. You caress
                it gently to remind yourself of this fact.
            }
        }
        else {
            
            if `not (eq heldBook "None")` {
                respond {
                    You can really only carry one book at a time,
                    so you lovingly deposit `heldBook` in its
                    proper place on the bookshelf.
                }
            }
            set heldBook "Passion in a Pot";
            respond {
                You pick up `heldBook`.
            }
        }
    }
    command take passion in poppy field {
        if `eq heldBook "Passion in a Poppy Field"` {
            respond {
                You're already holding `heldBook`. You caress
                it gently to remind yourself of this fact.
            }
        }
        else {
            
            if `not (eq heldBook "None")` {
                respond {
                    You can really only carry one book at a time,
                    so you lovingly deposit `heldBook` in its
                    proper place on the bookshelf.
                }
            }
            set heldBook "Passion in a Poppy Field";
            respond {
                You pick up `heldBook`.
            }
        }
    }
    command take fantasy series {
        if `eq heldBook "the fantasy book"` {
            respond {
                You're already holding `heldBook`. You caress
                it gently to remind yourself of this fact.
            }
        }
        else {
            
            if `not (eq heldBook "None")` {
                respond {
                    You can really only carry one book at a time,
                    so you lovingly deposit `heldBook` in its
                    proper place on the bookshelf.
                }
            }
            set heldBook "the fantasy book";
            respond {
                You pick up `heldBook`.
            }
        }
    }
    command set things on fire {
        respond {
            Don't just indiscriminately burn this man's possessions!
            That chair looks pretty burnable, though.
        }
    }
    command open cabinet {
        respond  {
            This filing cabinet has three doors.
            They are all conveniently labeled. You
            like opening your doors one at a time in order
            to savor the experience.
        }
    }
    command pet cat {
        respond {
            Here, kitty, kitty...
            
            HISSSSSSSSSS
            
            Oh well.
        }
    }
    command open 1 {
        respond {
            It's locked. Maybe whoever lives here
            doesn't want you rifling through all their papers? Odd.
        }
    }
    command open 2 {
        respond {
            It's locked. Maybe whoever lives here
            doesn't want you rifling through all their papers? Odd.
        }
    }
    command open 3 {
        respond {
            It's locked. Maybe whoever lives here
            doesn't want you rifling through all their papers? Odd.
        }
    }
    object alarm {
        You don't see a fire alarm. This room looks pretty fire
        safe anyway, so you don't worry about it.
    }
    object cat {
        That darned cat is lurking in the hallway. She hisses at you
        every time you try to get near her.
    }
    object vonnegut {
        You like Vonnegut, but you're not really in love
        with him. He's no Santiago.

        The books look well loved.
    }
    object books in another language {
        This sure isn't English. You're sure, because you can 
        read English.
    }
    object passion in paradise {
        Santiago was content to live a laid-back life of
        professional surfing and beachcombing, but everything
        changes the night he meets Karen Naymon, a journalist
        on the hunt for one of the Caribbean's most powerful
        drug lords. Santiago and Karen embark on a dangerous
        journey, and realize that all is not as it seems in
        paradise. With betrayal and lies on all sides, will
        Karen learn to trust Santiago?

        "Smoldering" - LA Times Review
    }
    object passion in pompeii {
        The year is 79 AD, and Karen Naymon is due to be married.
        Her family insists she choose a wealthy politician who
        will secure her position in the Roman elite. But Karen
        has other ideas - and her eye on Santiago, a slave captured
        from the barbaric wars of barbarians. Will love erupt between
        Karen and Santiago? Will Karen escape her familyâ€¦ and the
        trouble brewing at Mount Vesuvius?
    }
    object passion in pot {
        Santiago works late nights at his recently opened
        restaurant in Chicago, The Firepit. He has always dreamed
        of being a chef, and with a good review from top food
        critic Karen Naymon, The Firepit will be on its way to
        fame and fortune. But when Karen and Santiago meet,
        the kitchen gets hot. CAN THEY MAINTAIN A DEGREE OF
        PROFESSIONALISM IN THEIR RELATIONSHIP??
    }
    object passion in poppy field {
        Karen has waited for Santiago to return from the Allied
        front in Germany for a year. But the war has changed 
        Santiago. Karen must find a way to cope with Santiago's
        loss of a leg. The increasingly volatile Santiago can be
        kind of a jackass, but he's seen things, you know? Can
        Karen and Santiago find peace together? 
    }
    object rock {
        This is the worst rock collection you have ever seen. 
        Every cubby in the display box has a piece of flint. 
        There are no other types of rock.
        
        You're reminded of that song Jackie Chan sings in 
        that movie about traffic. 
        
        Flint, huh, yeah! What is it good for?

        Starting fires, based on your impeccable scouting
        knowledge. Your knowledge of Jackie Chan movies,
        however, is dubious.
    }
    object cubby {
        A plain cubby with a piece of flint. An odd choice for
        decor, to be sure, but maybe it works here.
    }
    object flint {
        It's just like those piece of flint you used in camp while
        the camp leaders shouted at you for being such a miserable
        little child who couldn't even make a fire. You showed them
        when you lit the campsite on fire.
    }
    object bookshelf {
        This bookshelf looks Swedish and self-assembled, and has 
        some familiar titles. On the top shelf is
        some weird fantasy series, and a collection
        of every Kurt Vonnegut novel in existence. The bottom shelf
        has some books in another language, and all of the Claire
        Lovesmith books! Passion in Paradise, Passion in Pompeii,
        Passion in a Poppy Field, Passion in a Potâ€¦
    }
    object fantasy series {
        Every cover features a muscular man waving a sword at a dragon.
        Maybe you could get into this. There are probably a bunch
        of made up names, though. Thurglarg, son of Mardragoglan.
        The muscular man sort of looks like a Thurglarg.
    }
    object couch {
        A nice, normal, comfy couch.
    }
    object decor {
        Well, there's a rock collection and a painting.
    }
}

location room-one puzzle-room {
    synonym "burn chair" "use rock on chair" "use rock on book"
    "use rock on leaves of grass" "use rock with chair" "use rock with book"
    "use rock with leaves of grass"
    "start fire" "set chair on fire" "ignite chair" "ignite book"
    "set book on fire" "burn book" "ignite leaves of grass" 
    "set leaves of grass on fire" "burn leaves of grass"
    "set fire to chair" "fire";
    synonym "put book on chair";
    
    command look { 
        respond {
            This room looks very familiar. There's the
            cat again! You can see it through the doorway. 
            It stares unblinking at you, and you feel a little unnerved.

            At least there's a lot of nice decor to enjoy in here.
            Well, the painting on the wall is also a little bit creepy.
            But that armchair looks amazingly comfortable,
            and the sofa is normal enough. The decor is rather
            minimal, with some sort of rock collection hung in
            a pigeonholed box on the wall, and a filing
            cabinet and bookshelf tucked in the corners.
        }
        if `roomOnFire` {
            respond {
                Also the chair is on fire. You might want to
                get out of here.
            }
        }
    }
    command put painting on chair {
        respond {
            The painting doesn't come off the wall, otherwise
            you'd happily burn it.
        }
    }
    command put package on chair {
        respond {
            You can't bring yourself to burn packages, even mangled open
            ones.
        }
    }
    command put medallion on chair {
        respond {
            You place the medallion on the chair. It doesn't
            spontaneously combust, so you pick it back up.
        }
    }
    command put bookshelf on chair {
        respond {
            Which book?
        }
    }
    # Should do something about heldBook in command...
    command put book on chair {
        if `eq heldBook "None"` {
            respond {
                You don't have a book on you.
            }
        }
        else {
            if `eq heldBook "Leaves of Grass"` {
                respond {
                    You can't believe you! This book is in no
                    way expendable. Well...hmm. Maybe it is a little
                    bit expendable. You put the crotch-mentioning 
                    book on the chair. 
                }
                set heldBook "None";
                set placedBook 1;
            }
            else {
                respond {
                    You can't believe you! This book is in no way
                    expendable. You are absolutely not setting
                    fire to this. Never.
                }
            }
        }
    }
    command use chair {
        trigger sit chair;
    }
    command take chair {
        if `roomOnFire` {
            respond {
                The chair is on fire. Bad idea.
            }
        }
        else {
            respond {
                Some odd part of you wants to burn that chair rather
                than shove it in your pocket.
            }
        }
    }
    command sit chair {
        if `roomOnFire` {
            respond {
                That chair is kind of on fire. Not a good
                idea. You might want to get out.
            }
        }
        else {
            if `placedBook` {
                respond {
                    You seat yourself righ next to "Leaves of Grass,"
                    which should soon burn. So comfy! You get up again.
                }
            }
            else {
                respond {
                    This really is a comfy chair.
                }
            }
        }
    }
    command put leaves of grass on chair {
        if `eq heldBook "Leaves of Grass"` {
            respond {
                You can't believe you! This book is in no
                way expendable. Well...hmm. Maybe it is a little
                bit expendable. You put the crotch-mentioning 
                book on the chair. 
            }
            set heldBook "None";
            set placedBook 1;
        }
        else {
            respond {
                You aren't holding that book.
            }
        }
    }
    command put fantasy series on chair {
        if `eq heldBook "the fantasy book"` {
            respond {
                You can't believe you! This book is in no
                way expendable. You are absolutely not setting
                fire to this. Never.
            }
        }
        else {
            respond {
                You aren't holding that book.
            }
        }
    }
    command put vonnegut on chair {
        if `eq heldBook "a Kurt Vonnegut novel"` {
            respond {
                You can't believe you! This book is in no
                way expendable. You are absolutely not setting
                fire to this. Never.
            }
        }
        else {
            respond {
                You aren't holding that book.
            }
        }
    }
    command put books in another language on chair {
        if `eq heldBook "a book in another language"` {
            respond {
                You can't believe you! This book is in no
                way expendable. You are absolutely not setting
                fire to this. Never.
            }
        }
        else {
            respond {
                You aren't holding that book.
            }
        }
    }
    command put passion in poppy field on chair {
        if `eq heldBook "Passion in a Poppy Field"` {
            respond {
                You can't believe you! This book is in no
                way expendable. You are absolutely not setting
                fire to this. Never.
            }
        }
        else {
            respond {
                You aren't holding that book.
            }
        }
    }
    command put passion in pompeii on chair {
        if `eq heldBook "Passion in Pompeii"` {                
            respond {
                You can't believe you! This book is in no
                way expendable. You are absolutely not setting
                fire to this. Never.
            }
        }
        else {
            respond {
                You aren't holding that book.
            }
        }
    }
    command put passion in pot on chair {
        if `eq heldBook "Passion in a Pot"` {
            respond {
                You can't believe you! This book is in no
                way expendable. You are absolutely not setting
                fire to this. Never.
            }
        }
        else {
            respond {
                You aren't holding that book.
            }
        }
    }
    command put passion in paradise on chair {
        if `eq heldBook "Passion in Paradise"` {
            respond {
                You can't believe you! This book is in no
                way expendable. You are absolutely not setting
                fire to this. Never.
            }
        }
        else {
            respond {
                You aren't holding that book.
            }
        }
    }
    command burn chair {
        if `hasFlint` {
            if `placedBook` {
                respond {
                    You hold a piece of flint in your hand and remember
                    that you need steel to make this work. Sigh. 

                    Scouting also taught you that lighters can start
                    fires. Why are you even bothering with this rock?
                    You pull out your trusty lighter from your jacket
                    and set the book aflame. Your lighter is very
                    trusty and very forgettable.

                    The little maroon teapots quickly become little
                    black teapots and then 
                    impossible-to-see-over-the-flames, likely 
                    nonexistent teapots. Now might be a good time
                    to leave, if you don't want to go the way of
                    the teapots.
                }
                set roomOnFire 1;
                if `eq hintsState "burn"` {
                    set hintsState "fire";
                    set hintsCounter 0;
                }
            }
            else {
                respond {
                    As much as you enjoying starting fire in 
                    strangers' houses you have broken into,
                    you think you need to put some kindling on the
                    chair first. Something paper and expendable.
                }
            }
        }
        else {
            respond { 
                You don't have any flint. How do you expect to
                start a fire?
            }
        }
    }
    command leave {
        if `roomOnFire` {
            respond {
                That's probably a good idea. This place is heating up.
                With fire. The hallway is clouded in smoke, so you exit
                the room into the dark, unknown. The room you arrive in
                is happily free of smoke and flames. Why would you think
                there would be a fire anyway? Everything is beautiful.
            }
                
            set roomOnFire 0;
            move-to room-two;
            trigger look;
            if `eq hintsState "fire"` {
                set hintsState "scorch";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                There is work to be done! And that
                creepy cat is kind of lurking in the hallway,
                so you don't want to pass by her.
            }
        }
    }
    command read leaves of grass {
        trigger look leaves of grass;
    }
    command take elves {
        trigger look elves;
    }
    command look 1 {
        trigger open 1;
    }
    command look 2 {
        trigger open 2;
    }
    command look 3 {
        trigger open 3;
    }
    object painting {
        You don't know much about art history, but this painting
        looks like it was made by elves! 

        It's a portrait. Of a chair. It's the spitting image of the
        chair in this room, actually. The only difference is that
        the chair in the painting is wreathed in flames. You know,
        just really on fire. The real chair isn't on fire at all.
        That's a quality you like in a chair, not being on fire.

        Something about this painting makes you question that
        preference, though. It's a good painting. Very suggestive.
    }
    object elves {
        They might have made the painting, but the 
        elves didn't stick around here.
    }
    object chair {
        This chair is definitely not Swedish or self-assembled.
        (Chairs are not capable of assembling themselves, anyway.)
        You think it looks sort of Victorian, what with its clawed
        wooden feet and elegant curved lines. The fabric features
        a repeated pattern of little maroon teapots. The word
        'plush' rattles around in your head whenever you look at it.
    }
    object cabinet {
        A large metal structure with three drawers, helpfully labeled
        '1', '2', and '3', from the top down. You are
        vaguely nervous of something so professional
        and potentially well organized.
    }
    object leaves of grass {
        You open to a random page and begin reading until the line
        "Echoes, ripples, buzz'd whispers, love-root, silk-thread,
        crotch and vine." Your appreciation for the natural world
        is really thrown off by the word "crotch." You put the
        book down.
    }
    object bookshelf {
        This bookshelf looks Swedish and self-assembled, and has 
        some familiar titles. On the top shelf is Walt Whitman's
        Leaves of Grass, some weird fantasy series, and a collection
        of every Kurt Vonnegut novel in existence. The bottom shelf
        has some books in another language, and all of the Claire
        Lovesmith books! Passion in Paradise, Passion in Pompeii,
        Passion in a Poppy Field, Passion in a Potâ€¦
    }
}

location room-two puzzle-room {
    synonym "couch" "couch cushions" "cushion" "cushions";
    synonym "search" "search through" "search in" "look in" "look for";
    synonym "note" "love note" "letter" "love letter" "heart-shaped note";
    synonym "papers" "paper" "colored paper" "colored papers";
    synonym "pink" "pink paper" "pink page" "pink papers" "pink pages";
    synonym "white" "white paper" "white page" 
    "white papers" "white pages";
    synonym "green" "green paper" "green page" "green papers" "green pages";
    synonym "yellow" "yellow paper" "yellow page" "yellow papers" 
    "yellow pages";
    synonym "organize cabinet" "organize papers";
    synonym "blue" "blue paper" "blue page" "blue papers" "blue pages";
    synonym "put" "place" "set" "file";
    synonym "close cabinet" "close drawer" "close 1"
     "close 2" "close 3";
    synonym "look yellow" "read yellow";
    synonym "look blue" "read blue";
    synonym "look green" "read green";
    synonym "look pink" "read pink";
    synonym "look white" "read white"; 
    synonym "vomit" "throw up" "be sick";
    
    command look {
        respond {
            This room looks very familiar. It's like you've
            been here before, except you vaguely remember it
            being entirely wreathed in flames about to murder
            you with their fiery tongues. Huh. Strange.

            There's the cat again! You can see it through the doorway.
            It stares unblinking at you, and you feel a little unnerved.

            This place looks a beat up, or perhaps burned up, 
            but there's an odd painting on the wall. There's a nice,
            empty spot at the side of the room that looks like
            the perfect place to add an armchair with a maroon
            teapot pattern. But, sadly, there is no armchair, only
            an elaborate scorch mark where the armchair should go.
            The sofa still looks pretty nice, though.
            The decor is rather minimal, with some sort of rock
            collection hung in a pigeonholed box on the wall,
            and a filing cabinet and bookshelf tucked in the corners.
        }
        if `roomOnFire` {
            respond {
                Also the filing cabinet is on fire. You might want to
                get out of here.
            }
        }
    }
    command sit scorch {
        respond {
            You plop yourself down on top of the scorch marks.
            Man, this would be the perfect place for a nice 
            armchair. However, since scorch marks are not, in fact, an
            armchair, you are not very comfortable. You get up.
        }
    }
    command organize cabinet {
        respond {
            You have no idea how to proceed. Organization 
            is not your strong point. You'll need a little
            more direction.
        }
    }
    command look 1 {
        trigger open 1;
    }
    command look 2 {
        trigger open 2;
    }
    command look 3 {
        trigger open 3;
    }
    command open 1 {
        if `not hasNote` {
            if `roomOnFire` {
                respond {
                    The filing cabinet is on fire. Maybe you should
                    just leave?
                }
            }
            else {
                respond {
                    It's locked. Maybe whoever lives here
                    doesn't want you rifling through all their papers? Odd.
                }
            }
        }
        else {
            if `hasPapers` {
                respond {
                    This is where you found your yellow,
                    blue, green, white, and pink papers. Place them 
                    in the right drawers!
                }
            }
            else {
                respond {
                        You see five sheets of paper colored yellow,
                        blue, green, white, and pink. Otherwise
                        the drawer is empty.
                    }
                    set hasPapers 1;
                }
            }
    }
    command take papers {
        if `hasPapers` {
            respond {
                Pink, white, green, blue, and yellow papers.
                Place them in the right drawers.
            }
        }
        else {
            respond {
                What papers?
            }
        }
    }
    command open 2 {
        if `not hasNote` {
            if `roomOnFire` {
                respond {
                    The filing cabinet is on fire. Maybe you should
                    just leave?
                }
            }
            else {
                respond {
                    It's locked. Maybe whoever lives here
                    doesn't want you rifling through all their papers? Odd.
                }
            }
        }
        else {
            if `not hasPapers` {
                respond {
                    The drawer is empty. The guy who lives here never
                    quite learned how to stuff his filing cabinet
                    full of papers for strangers to pry through.
                }
            }
            else {
                respond {
                    Do some of the yellow, green, blue, white, or
                    pink papers go in here? 
                }
            }
        }
    }
    command open 3 {
        respond {
            It's locked. Maybe whoever lives here
            doesn't want you rifling through all their papers? Odd.
        }
    }
    command look pink {
        if `hasPapers` {
            respond {
                The paper is exactly the same shade of pink as
                the heart note you found under the cushions.
                In fact, there is a heart of exactly the same size
                cut out of the corner of this sheet of paper. What
                a coincidence! The top of the paper reads, in bold
                letters, "I am a free and independent spirit! I 
                belong in any drawer!"
            }
        }
        else {
            respond {
                What is this pink thing you are talking about?
                You aren't very fond of the color pink.
            }
        }
    }
    command look green {
        if `hasPapers` {
            respond {
                A beautiful, pure shade of green. Exactly the
                same color of green sheets of paper. This paper
                reads "I belong in drawer 1 and we are all telling
                the truth." What a trusting piece of paper!
                You feel complete trust toward all of these sheets
                of paper.
            }
        }
        else {
            respond {
                Green? What green are you talking about? The ice
                outside has removed all that is green and pleasant in
                the world.
            }
        }
    }
    command look yellow {
        if `hasPapers` {
            respond {
                A sheet of light yellow paper. Bold lettering spells
                out "I belong in drawer 1 and the blue paper
                is lying." Well, you never trusted blue papers anyway.
            }
        }
        else {
            respond {
                Yellow, like happiness and sushine. Too bad there isn't
                any of that in this town.
            }
        }
    }
    command look blue {
        if `hasPapers` {
            respond {
                Paper as blue as the sky, when the sky isn't
                all gray and cloudy and gloomy. It reads 
                "I belong in drawer 2 and the yellow paper is lying."
                Come to think of it, that yellow paper did look 
                suspicious.
            }
        }
        else {
            respond {
               Blue. Blue. Huh. You see no blue. Are you color blind?
               No wait, you vaguely remember blue. You're probably
               not color blind.
            }
        }
    }
    command look white {
        if `hasPapers` {
            respond {
                A piece of paper that is white. BORING.
                The black lettering spells out "I belong in drawer
                2 and green and yellow are lying." Wow. Come to
                think of it, all of the unpleasant news you've
                received lately did come on green and yellow paper.
                They're probably not trustworthy.
            }
        }
        else {
            respond {
               White. There's white paper in those books on the shelves.
               You like reading those!
            }
        }
    }
    command look papers {
        if `hasPapers` {
            respond {
                Papers of the colors pink, white, yellow,
                blue, and green. They seem
                to like arguing with each other.
            }
        }
        else {
            respond {
               What papers? The ones in books? Those are some
               great books.
            }
        }
    }
    command sort papers {
        if `hasPapers` {
            respond {
                You look at all the cryptic papers and feel
                an overwhelming sense of dread. Which one goes where?
            }
        }
        else {
            respond {
               What papers? The ones in books? Those are some
               great books.
            }
        }
    }
    command read papers {
        trigger look papers;
    }
    command close cabinet {
        if `hasPapers` {
            respond {
                This cabinet just doesn't feel organized to you.
                You'd rather continue sorting papers into their
                appropriate drawers.
            }
        }
        else {
            if `hasNote` {
                respond {
                    This cabinet needs organizing! Don't give up now!
                }
            }
            else {
                respond {
                    The drawers are already closed. And locked.
                }
            }
        }
    }
    command put note 1 {
        if `hasNote` {
            respond {
                Your nauseatingly pink heart doesn't
                belond in the cabinet.
            }
        }
        else {
            respond {
                You don't have any notes on you.
            }
        }
    }
    command put note 2 {
        if `hasNote` {
            respond {
                Your nauseatingly pink heart doesn't
                belond in the cabinet.
            }
        }
        else {
            respond {
                You don't have any notes on you.
            }
        }
    }
    command put note 3 {
        if `hasNote` {
            respond {
                Drawer 3 is locked.
            }
        }
        else {
            respond {
                You don't have any notes on you.
            }
        }
    }
    command put papers 1 {
        if `hasPapers` {
            respond {
                It's better to do this one paper at a time, you think.
            }
        }
        else {
            respond {
                You don't have any papers.
            }
        }
    }
    command put papers 2 {
        if `hasPapers` {
            respond {
                It's better to do this one paper at a time, you think.
            }
        }
        else {
            respond {
                You don't have any papers.
            }
        }
    }
    command put papers 3 {
        if `hasPapers` {
            respond {
                Drawer 3 is locked.
            }
        }
        else {
            respond {
                You don't have any papers.
            }
        }
    }
    command put pink 3 {
        if `hasPapers` {
            respond {
                Drawer 3 is locked.
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put blue 3 {
        if `hasPapers` {
            respond {
                Drawer 3 is locked.
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put white 3 {
        if `hasPapers` {
            respond {
                Drawer 3 is locked.
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put yellow 3 {
        if `hasPapers` {
            respond {
                Drawer 3 is locked.
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put green 3 {
        if `hasPapers` {
            respond {
                Drawer 3 is locked.
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put pink 1 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set pinkRight 1;
            if `and pinkRight (and whiteRight (and greenRight (and blueRight yellowRight)))` {
                respond {
                    You at once feel the satisfaction of a job well
                    done. That filing cabinet is so organized.
                    You close all the drawers and step back to admire
                    your beautiful work. The cabinet immediately bursts
                    into flames. Weird. You suppose it's kind of like
                    a burst of fireworks here to celebrate your
                    accomplishments. You admire it for a moment,
                    then decide you really better leave the room.
                }
                set hasPapers 0;
                set hasNote 0;
                set roomOnFire 1;
                if `eq hintsState "organize"` {
                    set hintsState "fire";
                    set hintsCounter 0;
                }
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put pink 2 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set pinkRight 1;
            if `and pinkRight (and whiteRight (and greenRight (and blueRight yellowRight)))` {
                respond {
                    You at once feel the satisfaction of a job well
                    done. That filing cabinet is so organized.
                    You close all the drawers and step back to admire
                    your beautiful work. The cabinet immediately bursts
                    into flames. Weird. You suppose it's kind of like
                    a burst of fireworks here to celebrate your
                    accomplishments. You admire it for a moment,
                    then decide you really better leave the room.
                }
                set hasPapers 0;
                set hasNote 0;
                set roomOnFire 1;
                if `eq hintsState "organize"` {
                    set hintsState "fire";
                    set hintsCounter 0;
                }
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put white 1 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set whiteRight 0;
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put white 2 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set whiteRight 1;
            if `and pinkRight (and whiteRight (and greenRight (and blueRight yellowRight)))` {
                respond {
                    You at once feel the satisfaction of a job well
                    done. That filing cabinet is so organized.
                    You close all the drawers and step back to admire
                    your beautiful work. The cabinet immediately bursts
                    into flames. Weird. You suppose it's kind of like
                    a burst of fireworks here to celebrate your
                    accomplishments. You admire it for a moment,
                    then decide you really better leave the room.
                }
                set hasPapers 0;
                set hasNote 0;
                set roomOnFire 1;
                if `eq hintsState "organize"` {
                    set hintsState "fire";
                    set hintsCounter 0;
                }
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put blue 1 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set blueRight 0;
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put blue 2 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set blueRight 1;
            if `and pinkRight (and whiteRight (and greenRight (and blueRight yellowRight)))` {
                respond {
                    You at once feel the satisfaction of a job well
                    done. That filing cabinet is so organized.
                    You close all the drawers and step back to admire
                    your beautiful work. The cabinet immediately bursts
                    into flames. Weird. You suppose it's kind of like
                    a burst of fireworks here to celebrate your
                    accomplishments. You admire it for a moment,
                    then decide you really better leave the room.
                }
                set hasPapers 0;
                set hasNote 0;
                set roomOnFire 1;
                if `eq hintsState "organize"` {
                    set hintsState "fire";
                    set hintsCounter 0;
                }
            }
        }        
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put green 1 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set greenRight 0;
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put green 2 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set greenRight 1;
            if `and pinkRight (and whiteRight (and greenRight (and blueRight yellowRight)))` {
                respond {
                    You at once feel the satisfaction of a job well
                    done. That filing cabinet is so organized.
                    You close all the drawers and step back to admire
                    your beautiful work. The cabinet immediately bursts
                    into flames. Weird. You suppose it's kind of like
                    a burst of fireworks here to celebrate your
                    accomplishments. You admire it for a moment,
                    then decide you really better leave the room.
                }
                set hasPapers 0;
                set hasNote 0;
                set roomOnFire 1;
                if `eq hintsState "organize"` {
                    set hintsState "fire";
                    set hintsCounter 0;
                }
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put yellow 1 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set yellowRight 0;
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command put yellow 2 {
        if `hasPapers` {
            respond {
                You place the paper lovingly in the drawer. 
                Right where it belongs.
            }
            set yellowRight 1;
            if `and pinkRight (and whiteRight (and greenRight (and blueRight yellowRight)))` {
                respond {
                    You at once feel the satisfaction of a job well
                    done. That filing cabinet is so organized.
                    You close all the drawers and step back to admire
                    your beautiful work. The cabinet immediately bursts
                    into flames. Weird. You suppose it's kind of like
                    a burst of fireworks here to celebrate your
                    accomplishments. You admire it for a moment,
                    then decide you really better leave the room.
                }
                set hasPapers 0;
                set hasNote 0;
                set roomOnFire 1;
                if `eq hintsState "organize"` {
                    set hintsState "fire";
                    set hintsCounter 0;
                }
            }
        }
        else {
            respond {
                You have no papers to add to the cabinet.
            }
        }
    }
    command take yellow {
        if `hasPapers` {
            respond {
                You take the yellow paper.
            }
            set yellowRight 0;
        }
        else {
            respond {
                You see no yellow paper.
            }
        }
    }
    command take blue {
        if `hasPapers` {
            respond {
                You take the blue paper.
            }
            set blueRight 0;
        }
        else {
            respond {
                You see no yellow paper.
            }
        }
    }
    command take white {
        if `hasPapers` {
            respond {
                You take the white paper.
            }
            set whiteRight 0;
        }
        else {
            respond {
                You see no yellow paper.
            }
        }
    }
    command take pink {
        if `hasPapers` {
            respond {
                You take the pink paper.
            }
            set pinkRight 0;
        }
        else {
            respond {
                You see no yellow paper.
            }
        }
    }
    command take green {
        if `hasPapers` {
            respond {
                You take the green paper.
            }
            set greenRight 0;
        }
        else {
            respond {
                You see no yellow paper.
            }
        }
    }
    command search couch {
        respond {
            Feeling somewhat invasive, you search through the couch
            cushions of this stranger's house. In another situation,
            your conscience might have made you stop, but you're
            pretty sure your conscience also made you burn down this
            stranger's chair, so you're not going to listen to that.
            Also, you think that cat is judging you.

        }
        if `and (not roomOnFire) (not hasNote)` {
            respond {
                Anyway, you find a note written on a 
                nauseatingly pink heart.

                You hear the filing cabinet click open behind you. Odd.
            }
            set hasNote 1;
            set hintsState "organize";
            set hintsCounter 0;
        }
        else {
            respond {
                You don't find anything else.
            }
        }
    }
    command open couch {
        trigger search couch;
    }
    command look heart {
        if `hasNote` {
            respond {
                Pink. It makes you want to vomit. There's
                also a note written on it.
            }
        }
        else {
            respond {
                Heart? Where? Murder it!
            }
        }
    }
    command look note {
        if `hasNote` {
            respond {
                It reads "SEND THIS TO 12 PEOPLE WITHIN THE NEXT DAY
                OR UR FAMILY NAME WILL BE CURSED 4EVER!!1  Also you
                should organize that filing cabinet." You think 
                it's kind of poetic in its own special way.
            }
        }
        else {
            respond {
                You don't see any notes to read.
            }
        }
    }
    command read note {
        trigger look note;
    }
    command read heart {
        trigger look note;
    }
    command vomit {
        if `hasNote` {
            respond {
                Ok, maybe the heart's not that bad.
            }
        }
        else {
            respond {
                But you're not feeling sick. Not yet at least. Wait,
                that sounded ominous. Then you realized you were talking
                to yourself, which made it less ominous.
            }
        }
    } 
    command leave {
        if `roomOnFire` {
            respond {
                Probably a good idea. The room is kind of on fire.
                You casually stroll out of the room and into 
                another non-flaming room. The setting feels oddly
                similar.
            }
            set roomOnFire 0;
            move-to room-three;
            trigger look;
            if `eq hintsState "fire"` {
                set hintsState "cabinet";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                You feel like there's work to be done here. 
                Besides, this room is kind of nice and not on fire,
                so why leave?.
            }
        }
    }
    command look scorch {
        respond {
            Black, charred marks decorate the floor.
            They're kind of blotchy and shapeless, but if
            you had to say what they looked like...well...they
            are roughly in the shape of a person looking
            through couch cushions for old love notes.
        }
        if `eq hintsState "scorch"` {
            set hintsState "notes";
            set hintsCounter 0;
        }
    }
    command burn papers {
        if `hasPapers` {
            respond {
                You're not sure these papers would be better
                on fire.
            }
        }
        else {
            respond {
                What papers?
            }
        }
    }
    command burn yellow {
        if `hasPapers` {
            respond {
                You're not sure these papers would be better
                on fire.
            }
        }
        else {
            respond {
                What papers?
            }
        }
    }
    command burn blue {
        if `hasPapers` {
            respond {
                You're not sure these papers would be better
                on fire.
            }
        }
        else {
            respond {
                What papers?
            }
        }
    }
    command burn green {
        if `hasPapers` {
            respond {
                You're not sure these papers would be better
                on fire.
            }
        }
        else {
            respond {
                What papers?
            }
        }
    }
    command burn pink {
        if `hasPapers` {
            respond {
                You're not sure these papers would be better
                on fire.
            }
        }
        else {
            respond {
                What papers?
            }
        }
    }
    command burn white {
        if `hasPapers` {
            respond {
                You're not sure these papers would be better
                on fire.
            }
        }
        else {
            respond {
                What papers?
            }
        }
    }
    command take fear pigs {
        trigger look fear pigs;
    }
    object painting {
        You don't know much about art history, but this painting
        looks like it was made by fear pigs!

        The entire painting is subsumed by the face of a black cat.
        The cat doesn't have any eyes. Somehow you still feel like it
        is watching you. You shudder involuntarily.
    }
    object fear pigs {
        The fear pigs didn't hang around here after they made this
        creepy painting.
    }
    object cabinet {
        A large metal structure with three drawers, helpfully labeled
        '1', '2', and '3', from the top down. You are
        vaguely nervous of something so professional
        and potentially well organized.
    }
}

location room-three puzzle-room {
    synonym "food" "cat food";
    
    command look {
        respond {
            This room looks very familiar. Something about it
            reminds you of a giant firestorm. But then again,
            a lot of things have been reminding you of fiery death
            lately.

            There's the cat again! You can see it through the doorway.
            It stares unblinking at you, and you feel a little unnerved.

            This room looks like its been through some hard times,
            where those hard times may or may not have involved
            copious amounts of fire. The odd painting on the wall
            looks unharmed, though. There's a nice, empty spot
            at the side of the room that looks like the perfect
            place to add an armchair with a maroon teapot pattern.
            But, sadly, there is no armchair, only an elaborate scorch
            mark where the armchair should go. 
            The sofa still looks pretty nice, though.
            The decor is rather
            minimal, with some sort of rock collection hung
            in a pigeonholed box on the wall, and bookshelf
            tucked in the corners. There is also a metal filing
            cabinet that looks like it once may have been very secure.
            Now, however, the metal has been warped and contorted as
            if by some intense heat.
        }
        if `roomOnFire` {
            respond {
                Also, the entire room is on fire. You might want to
                get out of here.
            }
        }
    }
    command open 1 {
        trigger look 1;
    }
    command open 2 {
        trigger look 2;
    }
    command open 3 {
        trigger look 3;
    }
    command look 3 {
        if `not roomOnFire`{
            respond {
                The drawer contains some questionable looking cat food.
                You're not sure why it's questionable, as it probably
                would not respond to any questions you ask it. You are
                particularly fond of cat food, so you take a handful.
            }
            set hasCatFood 1;
            if `eq hintsState "cabinet"` {
                set hintsState "feed";
                set hintsCounter 0;
            }
        }
        else {
            respond {
                There's cat food here. But just maybe you have better
                things to do with your life. Like get out of the burning
                room!
            }
        }
    }
    command take food {
        if `roomOnFire`{
            respond {
                The room is on fire. Stop bothering with cat
                food and get out!
            }
        }
        else {
            if `hasCatFood` {
                respond {
                    You already have a handful of cat food.
                }
            }
            else {
                respond {
                    You don't see any cat food.
                }
            }
        }
    }
    object food {
        Pellets of kitty goodness.
    }
    command sit scorch {
        respond {
            You plop yourself down on top of the scorch marks.
            Man, this would be the perfect place for a nice 
            armchair. However, since scorch marks are not, in fact, an
            armchair, you are not very comfortable. You get up.
        }
    }
    command question food {
        if `hasCatFood` {
            respond {
                You ask a series of questions including 
                "What is your name?", "How did the great founder
                Matusiak defeat the three-headed flamingo terrorizing
                the town?", and "Why can't human food be as conveniently
                labeled as cat food?" Sadly, the cat food makes no response.
            }
        }
        else {
            respond {
                You have nothing to question.
            }
        }
    }
    command eat food {
        if `hasCatFood` {
            respond {
                You tentatively lick the cat food. It's not nearly 
                as good as your favorite brand, Meow Meow Munchers,
                so you stop.
            }
        }
        else {
            respond {
                You have nothing to eat.
            }
        }
    }
    command look alarm {
        if `roomOnFire` {
            respond {
                You can't see it, but it's kind of loud. Also the
                room is on fire, and you think the loud beeping
                sound means you should get out.
            }
        }
        else {
            respond {
                You don't see a fire alarm. This room looks pretty fire
                safe anyway, so you don't worry about it.
            }
        }
    }
    command leave {
        if `roomOnFire` {
            respond {
                Yeah, this ship is going down, and you aren't going
                with it. And by ship, of course, you mean room consumed
                by a giant, fiery inferno. You leave for the next room
                just outside.
            }
                
            set roomOnFire 0;
            move-to room-four;
            trigger look;
            if `eq hintsState "fire"` {
                set hintsState "giveMedallion";
                set hintsCounter 0;
            }
            
        }
        else {
            respond {
                That cat looks hungry and you're afraid that
                she will eat you if you get anywhere near her. You'd
                prefer to keep your distance and stay in this room.
            }
        }
    }
    object 1 {
        The drawer is completely empty and terribly deformed.
    }
    object 2 {
        It's empty except for what looks like a few ashes of
        paper. They probably once had important information.
        Not anymore
    }
    object ashes {
        Crumbly and black. Approximately in the same
        shape as discarded ashes of paper.
    }
    object cabinet {
        This cabinet has seen better days. Or, if it hasn't,
        you feel kind of sorry for it because clearly today is not
        a great day to be this filing cabinet. The metal structure
        is so warped that all three of the drawers are loose.
        Conveniently, the drawers are marked 1, 2, and 3.
    }
    object painting {
        You don't know much about art history, but you hate this
        painting!

        The cat's face stares down at you, with only one giant,
        yellow eye. The right side of the face is inky blackness.
    }
    object scorch {
        Black, charred marks decorate the floor.
        They're kind of blotchy and shapeless, but if
        you had to say what they looked like...well...they
        are roughly in the shape of a person looking
        through couch cushions for old love notes.
    }
}

location room-four puzzle-room {
    synonym "man" "mr. robertson" "robertson" 
    "stuart" "stuart robertson" "person" "guy";
    synonym "talk" "talk to" "speak" "speak to"
     "converse" "converse with";
    synonym "look man" "oogle man";
    synonym "emily" "emilys put" "emilys house" "emilys"  
    "emily house";
    synonym "drive home" "go home" "go emily" "drive to home"
    "drive to emily" "drive emily";


    command look {
        respond {
            What a beautiful room! There's a lot of nice decor to enjoy
            in here. That painting on the wall is just the sweetest
            thing ever and the armchair looks amazingly comfortable.
            The sofa is normal enough. There's some sort of rock 
            collection hung in a pigeonholed box on the wall, and a
            secure and official-looking filing cabinet and bookshelf
            tucked in the corners.

            The fire alarm is going off. You're not sure why, since
            you don't see a fire. Dumb fire alarm. If there were a 
            fire, you'd see it, obviously.

            You stand around for a little bit, but the sound is just
            unbearably annoying. Just as you're about to stab your
            ears with that jagged piece of flint you have in your
            pocket for some unknown reason, a man walks into the room.
            And boy is he attractive.

            He reaches for that round white thing on the ceiling that
            you never bothered to mention before because you had no
            idea what it was. After he presses a button, the alarm
            just stops. Magic!
        }
    }
    command talk {
        trigger talk man;
    }
    command drive home {
        respond {
            You should say good bye to this handsome man first.
        }
    }
    command talk man {
        if `not beganConv` {
            respond {
                You open your mouth to speak. He jumps, just noticing you.
                "Oh, hello," he says. "I'm Stuart Robertson." He does not
                feel particularly perturbed about you randomly being in his
                house. What a nice man!
            }
            set beganConv 1;
        }
        respond {
            What would you like to say?
            
            (say 1) "Nice to meet you! I was just admiring your yard,
            so I went to the back and admired the slightly open window
            and well, now I'm here!"
            
            (say 2) "I think this is your creepy medallion"
            
            (say 3) "I had a revelation in the post office that
            I need to start taking charge of my life"
            
            (say 4) "Who are you? I don't think we met before."
            
            (say 5) "You have a really attractive smile."
            
            (say 6) "I really ought to be going. Sorry about the
            breaking in and entering thing."
        }
    }
    command 1 {
        if `packagePanic` {
            respond {
                Package package package!
            }
        }
        else {
            if `beganConv` {
                respond {
                    "Yeah, I love my yard," he says. "Did you see the
                    reindeer out back? They're just adorable!"
                }
                trigger talk man;
            }
            else {
                respond {
                    What are you trying to communicate here?
                }
            }
        }
    }
    command 2 {
        if `packagePanic` {
            respond {
                Package package package!
            }
        }
        else {
            if `beganConv` {
                if `hasMedallion` {
                    respond {
                        Reluctantly, you take out the medallion and hand
                        it over to him. You've become rather attached to that
                        medallion, but it belongs to him after all.
        
                        "Oh wow! That's where it went!" Stuart responds,
                        taking the medallion. "I was so worried about that
                        when it didn't show up. Actually, I received this
                        package and I can't make out who it's supposed
                        to be for, but I don't think it's mine. Here, why
                        don't you take it."
        
                        Package, package, package! You eagerly receive
                        the brown parcel.
                    }
                    set hasMedallion 0;
                    set hasEmilyPackage 1;
                    set packagePanic 1;
                    if `eq hintsState "giveMedallion"` {
                        set hintsState "deliver2";
                        set hintsCounter 0;
                    }
                }
                else {
                    respond {
                        Stuart looks at you with an expression of mild
                        confusion. "You just gave me the medallion,"
                        he say. Oh yeah. Now you remember.
                    }
                    trigger talk man;
                }  
            }
            else {
                respond {
                    What are you trying to communicate here?
                }
            }
        }
    }
    command 3 {
        if `packagePanic` {
            respond {
                Package package package!
            }
        }
        else {
            if `beganConv` {
                respond {
                    He looks at you curiously for a moment, and 
                    then says, "You know, I had the same revelation
                    in the supermarket on Thursday."

                    You think this could be the start of a really deep
                    and touching discussion between you two, but you
                    don't know what else to say. Instead, you just kind
                    of stand there awkwardly, blinking.
                }
                trigger talk man;
            }
            else {
                respond {
                    What are you trying to communicate here?
                }
            }
        }
    }
    command 4 {
        if `packagePanic` {
            respond {
                Package package package!
            }
        }
        else {
            if `beganConv` {
                respond {
                    "I'm Stuart Robertson," Stuart replies, even though
                    he already introduced himself. "I just moved here
                    a week ago and I've been having all my stuff
                    shipped to me"

                    You feel a slight twinge of jealousy when you think
                    of all the packages he must be receiving.
                }
                trigger talk man;
            }
            else {
                respond {
                    What are you trying to communicate here?
                }
            }
        }
    }
    command 5 {
        if `packagePanic` {
            respond {
                Package package package!
            }
        }
        else {
            if `beganConv` {
                respond {
                    He smiles, just briefly, and those pearly
                    whites just absolutely glimmer. Beautiful. No
                    other words can describe that smile. Except
                    maybe "perfect" or "breathtaking" or maybe
                    even "cute."
                }
                trigger talk man;
            }
            else {
                respond {
                    What are you trying to communicate here?
                }
            }
        }
    }
    command 6 {
        if `packagePanic` {
            respond {
                Package package package!
            }
        }
        else {
            if `beganConv` {
                if `hasMedallion` {
                    respond {
                        You came all this way to deliver that creepy
                        medallion to this guy. You really like it,
                        but maybe you ought to hand it over since
                        it's not yours?
                    }
                }
                else {
                    respond {
                        "Yeah, that might be a good idea," he says. "I was
                        thinking about closing the window soon since
                        it's getting cold in here."
                    }
                    if `not (eq heldBook "None")` {
                        respond {
                            You dig into your pockets and pull out `heldBook`.
                            "Here", you say. "This somehow ended up in my
                            pocket."

                            "How strange!" he responds, with a delighted smile.
                            That book has been missing for weeks. 
                            He takes `heldBook` from you and carefully places it
                            on the bookshelf beside the copy of "Leaves of Grass".
                            You feel a little confused, but you're not quite sure
                            why.
                        }
                        set heldBook "None";
                    }
                    respond {
                        You take one last look at that perfect smile
                        that he would have on his face if he 
                        just smiled, then squeeze
                        yourself back through the open window. You're
                        pretty sure one of the reindeer winks at you
                        as you pass by it while getting a running
                        start to jump over the bushes. You only manage
                        to jump over about half the height of the bushes,
                        which actually isn't helpful at all.
                        So instead, you squeeze your way past,
                        acquiring a few scratches along the way,
                        and arrive by your car.
                    }
                    move-to robertson-front-door;
                }
            }
            else {
                respond {
                    What are you trying to communicate here?
                }
            }
        }
    }
    command take renaissance masters {
        trigger look renaissance masters;
    }
    object man {
        This is probably the Mr. Robertson who that package was
        meant for. You can tell because he has a really nice smile
        and you always imagined him with a nice smile. He's not
        even smiling and you know he has a nice smile. Also, you
        just broke into Mr. Robertson's house, so that makes sense.
    }
    object painting {
        You don't know much about art history, but this 
        painting looks like it was made by Renaissance masters!

        A handsome man sits regally in a comfortable armchair. 
        An adorable black cat curls in a ball on his lap.
    }
    object renaissance masters {
        They're probably dead now.
    }
    object chair {
        This chair is definitely not Swedish or self-assembled.
        (Chairs are not capable of assembling themselves, anyway.)
        You think it looks sort of Victorian, what with its clawed
        wooden feet and elegant curved lines. The fabric features
        a repeated pattern of little maroon teapots. The word
        'plush' rattles around in your head whenever you look at it.
    }
    object filing cabinet {
        A large metal structure with three drawers, helpfully labeled
        '1', '2', and '3', from the top down. You are
        vaguely nervous of something so professional
        and potentially well organized.
    }
}
